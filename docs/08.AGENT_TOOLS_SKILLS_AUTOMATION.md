# Agent å·¥å…·èˆ‡æŠ€èƒ½è‡ªå‹•åŒ–è¨­è¨ˆ

**ç‰ˆæœ¬**ï¼šv1.0  
**å»ºç«‹æ—¥æœŸ**ï¼š2026-01-17  
**è¨­è¨ˆç›®æ¨™**ï¼šç§»é™¤æ‰‹å‹•é¸æ“‡å·¥å…·/æŠ€èƒ½ï¼Œæ”¹ç”± AI ä»£ç†æ¶æ§‹å¸«è‡ªå‹•æ¨è–¦

---

## ğŸ“‹ åŸ·è¡Œæ‘˜è¦

### ç¾ç‹€å•é¡Œ

- âŒ ä½¿ç”¨è€…åœ¨å»ºç«‹ Agent æ™‚éœ€è¦æ‰‹å‹•é¸æ“‡ Tools å’Œ Skills
- âŒ ä½¿ç”¨è€…å¯èƒ½ä¸çŸ¥é“è©²é¸å“ªäº›å·¥å…·
- âŒ å·¥å…·/æŠ€èƒ½åˆ†æ•£åœ¨ Agent å±¤ç´šï¼Œé›£ä»¥çµ±ä¸€ç®¡ç†

### è§£æ±ºæ–¹æ¡ˆ

- âœ… **ç§»é™¤å‰ç«¯æ‰‹å‹•é¸æ“‡å™¨**ï¼šä¸å†é¡¯ç¤º ToolSelector å’Œ SkillSelector
- âœ… **ç³»çµ±å±¤ç´šçµ±ä¸€ç®¡ç†**ï¼šæ‰€æœ‰å·¥å…·/æŠ€èƒ½è¨»å†Šåˆ° `tools_registry` å’Œ `skills_library`
- âœ… **AI è‡ªå‹•æ¨è–¦**ï¼šAI ä»£ç†æ¶æ§‹å¸«æ ¹æ“š Agent éœ€æ±‚è‡ªå‹•æ¨è–¦åˆé©çš„å·¥å…·/æŠ€èƒ½
- âœ… **è¶…ç´šç®¡å®¶å…±ç”¨**ï¼šç³»çµ±å±¤ç´šçš„è¨­å®šå¯åŒæ™‚çµ¦è¶…ç´šç®¡å®¶å’Œ Agent ä½¿ç”¨

---

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### ç¾æœ‰æ¶æ§‹åˆ†æ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç¾æœ‰æ¶æ§‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  ç³»çµ±å±¤ç´šï¼ˆçµ±ä¸€ç®¡ç†ï¼‰                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚tools_registryâ”‚  â”‚skills_libraryâ”‚                        â”‚
â”‚  â”‚ (æ‰€æœ‰å·¥å…·)   â”‚  â”‚ (æ‰€æœ‰æŠ€èƒ½)   â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚         â”‚                  â”‚                                â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                    â”‚                                         â”‚
â”‚                    â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  AI ä»£ç†æ¶æ§‹å¸«                        â”‚                  â”‚
â”‚  â”‚  (/api/agents/architect)              â”‚                  â”‚
â”‚  â”‚  â€¢ æŸ¥è©¢ tools_registry                 â”‚                  â”‚
â”‚  â”‚  â€¢ æŸ¥è©¢ skills_library                 â”‚                  â”‚
â”‚  â”‚  â€¢ æ ¹æ“š Agent éœ€æ±‚è‡ªå‹•æ¨è–¦              â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                    â”‚                                         â”‚
â”‚                    â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  Agent å±¤ç´šï¼ˆå€‹åˆ¥é…ç½®ï¼‰                â”‚                  â”‚
â”‚  â”‚  agents è¡¨ï¼š                           â”‚                  â”‚
â”‚  â”‚  â€¢ enabled_tools: string[]            â”‚                  â”‚
â”‚  â”‚  â€¢ enabled_skills: string[]           â”‚                  â”‚
â”‚  â”‚  â€¢ mcp_config: JSONB                  â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ”¹é€²å¾Œæ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ”¹é€²å¾Œæ¶æ§‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  ç³»çµ±å±¤ç´šï¼ˆçµ±ä¸€ç®¡ç†ï¼‰                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚tools_registryâ”‚  â”‚skills_libraryâ”‚  â”‚ mcp_servers  â”‚     â”‚
â”‚  â”‚ (æ‰€æœ‰å·¥å…·)   â”‚  â”‚ (æ‰€æœ‰æŠ€èƒ½)   â”‚  â”‚ (MCPè¨­å®š)    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                  â”‚                  â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                    â”‚                                         â”‚
â”‚                    â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  AI ä»£ç†æ¶æ§‹å¸«ï¼ˆå¢å¼·ç‰ˆï¼‰               â”‚                  â”‚
â”‚  â”‚  â€¢ æŸ¥è©¢æ‰€æœ‰ç³»çµ±å±¤ç´šå·¥å…·/æŠ€èƒ½/MCP       â”‚                  â”‚
â”‚  â”‚  â€¢ æ ¹æ“š Agent éœ€æ±‚æ™ºèƒ½æ¨è–¦             â”‚                  â”‚
â”‚  â”‚  â€¢ ç”Ÿæˆ suggested_tools/skills        â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                    â”‚                                         â”‚
â”‚                    â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  Agent å»ºç«‹æµç¨‹ï¼ˆç°¡åŒ–ï¼‰                â”‚                  â”‚
â”‚  â”‚  1. ä½¿ç”¨è€…è¼¸å…¥éœ€æ±‚                      â”‚                  â”‚
â”‚  â”‚  2. AI ä»£ç†æ¶æ§‹å¸«ç”Ÿæˆå»ºè­°                â”‚                  â”‚
â”‚  â”‚  3. ä½¿ç”¨è€…ç¢ºèªï¼ˆå¯èª¿æ•´ï¼‰                 â”‚                  â”‚
â”‚  â”‚  4. è‡ªå‹•å¥—ç”¨åˆ° Agent                    â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                              â”‚
â”‚  å…±ç”¨å±¤ç´š                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  è¶…ç´šç®¡å®¶                              â”‚                  â”‚
â”‚  â”‚  â€¢ ä½¿ç”¨ç›¸åŒçš„ tools_registry           â”‚                  â”‚
â”‚  â”‚  â€¢ ä½¿ç”¨ç›¸åŒçš„ skills_library           â”‚                  â”‚
â”‚  â”‚  â€¢ ä½¿ç”¨ç›¸åŒçš„ mcp_servers              â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ å¯¦ä½œæ–¹æ¡ˆ

### Step 1ï¼šç§»é™¤å‰ç«¯æ‰‹å‹•é¸æ“‡å™¨

**æª”æ¡ˆ**ï¼š`components/agents/AgentEditor.tsx`

```typescript
// ç§»é™¤ä»¥ä¸‹å€å¡Šï¼š
{/* Tools Selector */}
<ToolSelector
    selectedTools={formData.enabled_tools || []}
    onChange={(tools) => setFormData(prev => ({ ...prev, enabled_tools: tools }))}
    className="border-b border-white/5 pb-10"
/>

{/* Skills Selector */}
<SkillSelector
    selectedSkills={formData.enabled_skills || []}
    onChange={(skills) => setFormData(prev => ({ ...prev, enabled_skills: skills }))}
/>
```

**æ”¹ç‚º**ï¼šé¡¯ç¤º AI æ¨è–¦çš„å·¥å…·/æŠ€èƒ½ï¼ˆå”¯è®€ï¼‰

```typescript
{/* AI æ¨è–¦çš„å·¥å…·èˆ‡æŠ€èƒ½ï¼ˆå”¯è®€é¡¯ç¤ºï¼‰ */}
{formData.enabled_tools && formData.enabled_tools.length > 0 && (
    <div className="space-y-4">
        <h3 className="text-sm font-semibold text-text-secondary">
            ğŸ¤– AI æ¨è–¦çš„å·¥å…·
        </h3>
        <div className="flex flex-wrap gap-2">
            {formData.enabled_tools.map(toolId => (
                <span
                    key={toolId}
                    className="px-3 py-1 bg-primary-500/10 border border-primary-500/20 rounded-full text-xs text-primary-400"
                >
                    {toolNames[toolId] || toolId}
                </span>
            ))}
        </div>
        <p className="text-xs text-text-tertiary">
            é€™äº›å·¥å…·ç”± AI ä»£ç†æ¶æ§‹å¸«æ ¹æ“šæ‚¨çš„éœ€æ±‚è‡ªå‹•æ¨è–¦
        </p>
    </div>
)}

{formData.enabled_skills && formData.enabled_skills.length > 0 && (
    <div className="space-y-4">
        <h3 className="text-sm font-semibold text-text-secondary">
            ğŸ¯ AI æ¨è–¦çš„æŠ€èƒ½
        </h3>
        <div className="flex flex-wrap gap-2">
            {formData.enabled_skills.map(skillId => (
                <span
                    key={skillId}
                    className="px-3 py-1 bg-purple-500/10 border border-purple-500/20 rounded-full text-xs text-purple-400"
                >
                    {skillNames[skillId] || skillId}
                </span>
            ))}
        </div>
        <p className="text-xs text-text-tertiary">
            é€™äº›æŠ€èƒ½ç”± AI ä»£ç†æ¶æ§‹å¸«æ ¹æ“šæ‚¨çš„éœ€æ±‚è‡ªå‹•æ¨è–¦
        </p>
    </div>
)}
```

### Step 2ï¼šå¢å¼· AI ä»£ç†æ¶æ§‹å¸«

**æª”æ¡ˆ**ï¼š`app/api/agents/architect/route.ts`

**ç¾æœ‰åŠŸèƒ½**ï¼ˆå·²å¯¦ä½œï¼‰ï¼š
- âœ… æŸ¥è©¢ `tools_registry`
- âœ… æŸ¥è©¢ `skills_library`
- âœ… åœ¨ Prompt ä¸­åŒ…å«å¯ç”¨å·¥å…·/æŠ€èƒ½åˆ—è¡¨
- âœ… ç”Ÿæˆ `suggested_tools` å’Œ `suggested_skills`

**éœ€è¦å¢å¼·**ï¼š

```typescript
// 2.3 æŸ¥è©¢ç³»çµ±å±¤ç´šçš„ MCP Serversï¼ˆæ–°å¢ï¼‰
const { data: mcpServers } = await supabase
    .from('mcp_servers')
    .select('name, display_name, description, capabilities')
    .eq('is_active', true);

const availableMCPServers = mcpServers?.map(m => 
    `- [${m.name}] ${m.display_name}: ${m.description}
  èƒ½åŠ›: ${m.capabilities?.join(', ') || 'ç„¡'}`
).join('\n') || "æš«ç„¡å¯ç”¨çš„ MCP Servers";

// åœ¨ metaPrompt ä¸­åŠ å…¥ MCP Servers è³‡è¨Š
const metaPrompt = `
    ...
    **å¯ç”¨ MCP Servers (Available MCP Servers)**:
    ${availableMCPServers}
    
    **MCP é…ç½®å»ºè­°**:
    å¦‚æœ Agent éœ€è¦é€£æ¥å¤–éƒ¨æœå‹™ï¼ˆå¦‚ Gmailã€Slackï¼‰ï¼Œè«‹åœ¨ \`mcp_config\` ä¸­é…ç½®å°æ‡‰çš„ MCP Serverã€‚
    ä¸€èˆ¬æƒ…æ³ä¸‹ï¼Œå„ªå…ˆä½¿ç”¨ \`suggested_tools\`ï¼Œåªæœ‰åœ¨éœ€è¦è¤‡é›œçš„ MCP æ•´åˆæ™‚æ‰ä½¿ç”¨ \`mcp_config\`ã€‚
    ...
`;
```

### Step 3ï¼šç³»çµ±å±¤ç´š MCP/Skills ç®¡ç†

**åœ¨ç³»çµ±è¨­å®šé é¢æ–°å¢ MCP/Skills ç®¡ç†å€å¡Š**

```typescript
// app/dashboard/admin/system/MCPSkillsConfig.tsx

'use client';

export default function MCPSkillsConfig() {
    return (
        <div className="space-y-6">
            {/* MCP Servers ç®¡ç† */}
            <section>
                <h3 className="text-lg font-semibold mb-4">
                    ğŸ”Œ MCP Servers ç®¡ç†
                </h3>
                <p className="text-sm text-text-tertiary mb-4">
                    è¨»å†Šçš„ MCP Servers å¯åŒæ™‚ä¾›ã€Œè¶…ç´šç®¡å®¶ã€å’Œã€ŒAgent å»ºç«‹ã€ä½¿ç”¨
                </p>
                {/* MCP Server åˆ—è¡¨èˆ‡æ–°å¢è¡¨å–® */}
            </section>
            
            {/* Skills ç®¡ç† */}
            <section>
                <h3 className="text-lg font-semibold mb-4">
                    ğŸ¯ Skills ç®¡ç†
                </h3>
                <p className="text-sm text-text-tertiary mb-4">
                    ç³»çµ±å±¤ç´šçš„ Skills å¯åŒæ™‚ä¾›ã€Œè¶…ç´šç®¡å®¶ã€å’Œã€ŒAgent å»ºç«‹ã€ä½¿ç”¨
                </p>
                {/* Skills åˆ—è¡¨èˆ‡æ–°å¢è¡¨å–® */}
            </section>
        </div>
    );
}
```

### Step 4ï¼šç¢ºä¿è¶…ç´šç®¡å®¶èˆ‡ Agent å…±ç”¨

**è¨­è¨ˆåŸå‰‡**ï¼š

1. **å–®ä¸€ä¾†æº**ï¼šæ‰€æœ‰å·¥å…·/æŠ€èƒ½/MCP éƒ½è¨»å†Šåœ¨ç³»çµ±å±¤ç´š
2. **è‡ªå‹•ç™¼ç¾**ï¼šAI ä»£ç†æ¶æ§‹å¸«è‡ªå‹•æŸ¥è©¢ç³»çµ±å±¤ç´šè¨­å®š
3. **æ™ºèƒ½æ¨è–¦**ï¼šæ ¹æ“š Agent éœ€æ±‚è‡ªå‹•æ¨è–¦
4. **å…±ç”¨æ©Ÿåˆ¶**ï¼šè¶…ç´šç®¡å®¶å’Œ Agent ä½¿ç”¨ç›¸åŒçš„è³‡æ–™è¡¨

---

## ğŸ“Š è³‡æ–™æµç¨‹

### Agent å»ºç«‹æµç¨‹

```
1. ä½¿ç”¨è€…è¼¸å…¥éœ€æ±‚
   "æˆ‘è¦ä¸€å€‹è²¡å‹™åˆ†æ Agent"
        â”‚
        â–¼
2. å‰ç«¯å‘¼å« /api/agents/architect
        â”‚
        â–¼
3. AI ä»£ç†æ¶æ§‹å¸«ï¼š
   a. æŸ¥è©¢ tools_registryï¼ˆç³»çµ±å±¤ç´šï¼‰
   b. æŸ¥è©¢ skills_libraryï¼ˆç³»çµ±å±¤ç´šï¼‰
   c. æŸ¥è©¢ mcp_serversï¼ˆç³»çµ±å±¤ç´šï¼‰
   d. åˆ†æéœ€æ±‚ï¼Œæ™ºèƒ½æ¨è–¦
        â”‚
        â–¼
4. è¿”å› Blueprintï¼š
   {
     name: "è²¡å‹™åˆ†æ Agent",
     system_prompt: "...",
     suggested_tools: ["query_financial_data", "generate_report"],
     suggested_skills: ["financial_analysis"],
     mcp_config: {} // å¦‚æœéœ€è¦
   }
        â”‚
        â–¼
5. å‰ç«¯é¡¯ç¤º AI æ¨è–¦ï¼ˆå”¯è®€ï¼‰
   ä½¿ç”¨è€…ç¢ºèªå¾Œå»ºç«‹ Agent
```

### è¶…ç´šç®¡å®¶ä½¿ç”¨æµç¨‹

```
1. ç®¡ç†å“¡åœ¨ç³»çµ±è¨­å®šé é¢è¨»å†Š MCP Server
   ï¼ˆä¾‹å¦‚ï¼šGmail MCP Serverï¼‰
        â”‚
        â–¼
2. ç³»çµ±è‡ªå‹•ï¼š
   a. å„²å­˜åˆ° mcp_servers è¡¨
   b. ç™¼ç¾å¯ç”¨å·¥å…·ï¼ˆread_email, send_emailï¼‰
   c. è¨»å†Šåˆ° tools_registryï¼ˆå¯é¸ï¼‰
        â”‚
        â–¼
3. è¶…ç´šç®¡å®¶ Orchestrator Agentï¼š
   a. æŸ¥è©¢ tools_registry
   b. æŸ¥è©¢ mcp_servers
   c. è‡ªå‹•å¯ä½¿ç”¨é€™äº›å·¥å…·
        â”‚
        â–¼
4. åŒæ™‚ï¼ŒAI ä»£ç†æ¶æ§‹å¸«ï¼š
   a. æŸ¥è©¢ç›¸åŒçš„ tools_registry
   b. æŸ¥è©¢ç›¸åŒçš„ mcp_servers
   c. åœ¨å»ºç«‹ Agent æ™‚è‡ªå‹•æ¨è–¦
```

---

## âœ… æŠ€è¡“å¯è¡Œæ€§ç¢ºèª

### å•é¡Œ 1ï¼šAI ä»£ç†æ¶æ§‹å¸«èƒ½å¦è‡ªå‹•èª¿ç”¨ç³»çµ±å±¤ç´šè¨­å®šï¼Ÿ

**ç­”æ¡ˆ**ï¼šâœ… **å®Œå…¨å¯ä»¥**

**è­‰æ“š**ï¼š
- `app/api/agents/architect/route.ts` ç¬¬ 47-60 è¡Œå·²ç¶“æœƒæŸ¥è©¢ `tools_registry` å’Œ `skills_library`
- åœ¨ Prompt ä¸­åŒ…å«å¯ç”¨å·¥å…·/æŠ€èƒ½åˆ—è¡¨ï¼ˆç¬¬ 133-137 è¡Œï¼‰
- ç”Ÿæˆçš„ Blueprint åŒ…å« `suggested_tools` å’Œ `suggested_skills`ï¼ˆç¬¬ 190-191 è¡Œï¼‰

**åªéœ€è¦**ï¼š
- ç¢ºä¿ç³»çµ±å±¤ç´šçš„ MCP/Skills éƒ½è¨»å†Šåˆ°å°æ‡‰çš„è³‡æ–™è¡¨
- å¢å¼· AI ä»£ç†æ¶æ§‹å¸«ï¼Œè®“å®ƒä¹Ÿèƒ½æŸ¥è©¢ `mcp_servers` è¡¨

### å•é¡Œ 2ï¼šç§»é™¤å‰ç«¯é¸æ“‡å™¨å¾Œï¼Œä½¿ç”¨è€…å¦‚ä½•èª¿æ•´ï¼Ÿ

**ç­”æ¡ˆ**ï¼šé€é AI ä»£ç†æ¶æ§‹å¸«çš„å°è©±èª¿æ•´

**æµç¨‹**ï¼š
1. ä½¿ç”¨è€…çœ‹åˆ° AI æ¨è–¦çš„å·¥å…·/æŠ€èƒ½
2. å¦‚æœä¸æ»¿æ„ï¼Œå¯ä»¥ï¼š
   - åœ¨å°è©±ä¸­èªªã€Œä¸è¦ç”¨é€™å€‹å·¥å…·ã€æˆ–ã€ŒåŠ ä¸Šé€™å€‹å·¥å…·ã€
   - AI ä»£ç†æ¶æ§‹å¸«æœƒé‡æ–°ç”Ÿæˆå»ºè­°
   - æˆ–æä¾›ã€Œç·¨è¼¯å»ºè­°ã€æŒ‰éˆ•ï¼Œè®“ä½¿ç”¨è€…æ‰‹å‹•èª¿æ•´ï¼ˆä½†é è¨­ç”± AI æ¨è–¦ï¼‰

### å•é¡Œ 3ï¼šè¶…ç´šç®¡å®¶å’Œ Agent èƒ½å¦å…±ç”¨è¨­å®šï¼Ÿ

**ç­”æ¡ˆ**ï¼šâœ… **å®Œå…¨å…±ç”¨**

**æ¶æ§‹**ï¼š
- è¶…ç´šç®¡å®¶ï¼šæŸ¥è©¢ `tools_registry`ã€`skills_library`ã€`mcp_servers`
- Agent å»ºç«‹ï¼šAI ä»£ç†æ¶æ§‹å¸«æŸ¥è©¢ç›¸åŒçš„è¡¨
- å–®ä¸€ä¾†æºï¼šæ‰€æœ‰è¨­å®šéƒ½åœ¨ç³»çµ±å±¤ç´š

---

## ğŸ¯ å¯¦ä½œæ­¥é©Ÿ

### Phase 1ï¼šç§»é™¤å‰ç«¯é¸æ“‡å™¨ï¼ˆ1 å¤©ï¼‰

| ä»»å‹™ | æª”æ¡ˆ | èªªæ˜ |
|-----|------|------|
| ç§»é™¤ ToolSelector | `components/agents/AgentEditor.tsx` | è¨»è§£æˆ–åˆªé™¤ |
| ç§»é™¤ SkillSelector | `components/agents/AgentEditor.tsx` | è¨»è§£æˆ–åˆªé™¤ |
| æ–°å¢å”¯è®€é¡¯ç¤º | `components/agents/AgentEditor.tsx` | é¡¯ç¤º AI æ¨è–¦çš„å·¥å…·/æŠ€èƒ½ |

### Phase 2ï¼šå¢å¼· AI ä»£ç†æ¶æ§‹å¸«ï¼ˆ1 å¤©ï¼‰

| ä»»å‹™ | æª”æ¡ˆ | èªªæ˜ |
|-----|------|------|
| æŸ¥è©¢ MCP Servers | `app/api/agents/architect/route.ts` | æ–°å¢æŸ¥è©¢ `mcp_servers` è¡¨ |
| æ›´æ–° Prompt | `app/api/agents/architect/route.ts` | åœ¨ Prompt ä¸­åŠ å…¥ MCP Servers è³‡è¨Š |
| ç”Ÿæˆ MCP Config | `app/api/agents/architect/route.ts` | æ ¹æ“šéœ€æ±‚ç”Ÿæˆ `mcp_config` |

### Phase 3ï¼šç³»çµ±å±¤ç´šç®¡ç†ä»‹é¢ï¼ˆ2 å¤©ï¼‰

| ä»»å‹™ | æª”æ¡ˆ | èªªæ˜ |
|-----|------|------|
| å»ºç«‹ MCP Servers è¡¨ | Migration | å¦‚æœå°šæœªå»ºç«‹ |
| å»ºç«‹ç®¡ç†ä»‹é¢ | `app/dashboard/admin/system/MCPSkillsConfig.tsx` | MCP/Skills ç®¡ç† UI |
| å»ºç«‹ API ç«¯é» | `app/api/system/mcp-servers/route.ts` | CRUD API |

### Phase 4ï¼šæ¸¬è©¦èˆ‡å„ªåŒ–ï¼ˆ1 å¤©ï¼‰

| ä»»å‹™ | èªªæ˜ |
|-----|------|
| æ¸¬è©¦ Agent å»ºç«‹ | ç¢ºèª AI èƒ½æ­£ç¢ºæ¨è–¦å·¥å…·/æŠ€èƒ½ |
| æ¸¬è©¦è¶…ç´šç®¡å®¶ | ç¢ºèªèƒ½ä½¿ç”¨ç³»çµ±å±¤ç´šè¨­å®š |
| å„ªåŒ–æ¨è–¦é‚è¼¯ | æ ¹æ“šæ¸¬è©¦çµæœèª¿æ•´ AI Prompt |

---

## ğŸ“ è³‡æ–™æ¨¡å‹

### MCP Servers è¡¨ï¼ˆå¦‚æœå°šæœªå»ºç«‹ï¼‰

```sql
-- MCP Server è¨»å†Šè¡¨
CREATE TABLE IF NOT EXISTS mcp_servers (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    
    -- åŸºæœ¬è³‡è¨Š
    name TEXT NOT NULL UNIQUE, -- 'gmail', 'slack', 'notion'
    display_name TEXT NOT NULL,
    description TEXT,
    
    -- é€£æ¥è³‡è¨Š
    server_url TEXT NOT NULL, -- MCP Server URL
    server_type TEXT DEFAULT 'http', -- 'http', 'websocket', 'stdio'
    api_key TEXT, -- åŠ å¯†å„²å­˜ï¼ˆå¦‚æœéœ€è¦ï¼‰
    
    -- èƒ½åŠ›
    capabilities JSONB DEFAULT '[]', -- ['read_email', 'send_email']
    
    -- ç‹€æ…‹
    is_active BOOLEAN DEFAULT TRUE,
    last_health_check TIMESTAMPTZ,
    
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX IF NOT EXISTS idx_mcp_servers_active ON mcp_servers(is_active);
CREATE INDEX IF NOT EXISTS idx_mcp_servers_name ON mcp_servers(name);
```

---

## ğŸ¨ UI æ”¹é€²å»ºè­°

### Agent å»ºç«‹é é¢æ”¹é€²

**ç§»é™¤å‰**ï¼š
```
[å·¥å…·é¸æ“‡å™¨] â† ä½¿ç”¨è€…æ‰‹å‹•å‹¾é¸
[æŠ€èƒ½é¸æ“‡å™¨] â† ä½¿ç”¨è€…æ‰‹å‹•å‹¾é¸
```

**ç§»é™¤å¾Œ**ï¼š
```
ğŸ¤– AI æ¨è–¦çš„å·¥å…·
[search_knowledge] [query_financial_data] [generate_report]
é€™äº›å·¥å…·ç”± AI ä»£ç†æ¶æ§‹å¸«æ ¹æ“šæ‚¨çš„éœ€æ±‚è‡ªå‹•æ¨è–¦

ğŸ’¡ æƒ³è¦èª¿æ•´ï¼Ÿ
åœ¨å°è©±ä¸­å‘Šè¨´ AI ä»£ç†æ¶æ§‹å¸«æ‚¨çš„éœ€æ±‚ï¼Œå®ƒæœƒé‡æ–°ç”Ÿæˆå»ºè­°ã€‚
```

---

## ğŸ”„ é·ç§»ç­–ç•¥

### ç¾æœ‰ Agent çš„è™•ç†

**é¸é … 1**ï¼šä¿ç•™ç¾æœ‰é…ç½®
- å·²å»ºç«‹çš„ Agent ä¿æŒåŸæœ‰çš„ `enabled_tools` å’Œ `enabled_skills`
- æ–°å»ºç«‹çš„ Agent ä½¿ç”¨ AI æ¨è–¦

**é¸é … 2**ï¼šé‡æ–°ç”Ÿæˆå»ºè­°
- æä¾›ã€Œé‡æ–°ç”Ÿæˆå»ºè­°ã€æŒ‰éˆ•
- å‘¼å« AI ä»£ç†æ¶æ§‹å¸«ï¼Œæ ¹æ“š Agent æè¿°é‡æ–°æ¨è–¦å·¥å…·/æŠ€èƒ½

**å»ºè­°**ï¼šæ¡ç”¨é¸é … 1ï¼ˆä¿ç•™ç¾æœ‰é…ç½®ï¼‰ï¼Œé¿å…å½±éŸ¿å·²é‹ä½œçš„ Agent

---

## âœ… é©—æ”¶æ¨™æº–

### åŠŸèƒ½é©—æ”¶

| é …ç›® | é©—æ”¶æ¨™æº– | å„ªå…ˆç´š |
|-----|---------|-------|
| ç§»é™¤æ‰‹å‹•é¸æ“‡å™¨ | å‰ç«¯ä¸å†é¡¯ç¤º ToolSelector å’Œ SkillSelector | P0 |
| AI è‡ªå‹•æ¨è–¦ | AI ä»£ç†æ¶æ§‹å¸«èƒ½æ ¹æ“šéœ€æ±‚æ¨è–¦å·¥å…·/æŠ€èƒ½ | P0 |
| ç³»çµ±å±¤ç´šç®¡ç† | ç®¡ç†å“¡å¯åœ¨ç³»çµ±è¨­å®šé é¢ç®¡ç† MCP/Skills | P1 |
| è¶…ç´šç®¡å®¶å…±ç”¨ | è¶…ç´šç®¡å®¶èƒ½ä½¿ç”¨ç³»çµ±å±¤ç´šè¨­å®š | P0 |
| Agent å…±ç”¨ | Agent å»ºç«‹æ™‚èƒ½ä½¿ç”¨ç³»çµ±å±¤ç´šè¨­å®š | P0 |

### ä½¿ç”¨è€…é«”é©—é©—æ”¶

| é …ç›® | é©—æ”¶æ¨™æº– |
|-----|---------|
| å»ºç«‹ Agent æµç¨‹ | ä½¿ç”¨è€…åªéœ€è¼¸å…¥éœ€æ±‚ï¼ŒAI è‡ªå‹•æ¨è–¦å·¥å…·/æŠ€èƒ½ |
| æ¨è–¦æº–ç¢ºåº¦ | AI æ¨è–¦çš„å·¥å…·/æŠ€èƒ½ç¬¦åˆ Agent éœ€æ±‚ï¼ˆ>80%ï¼‰ |
| èª¿æ•´æ©Ÿåˆ¶ | ä½¿ç”¨è€…å¯ä»¥é€éå°è©±èª¿æ•´æ¨è–¦çµæœ |

---

## ğŸ“š ç›¸é—œæ–‡ä»¶

- [07.SUPER_ASSISTANT_DESIGN.md](./07.SUPER_ASSISTANT_DESIGN.md) - è¶…ç´šç®¡å®¶è¨­è¨ˆ
- [SKILLS_AND_TOOLS_IMPLEMENTATION_PLAN.md](./SKILLS_AND_TOOLS_IMPLEMENTATION_PLAN.md) - å·¥å…·èˆ‡æŠ€èƒ½å¯¦ä½œè¨ˆç•«
- `app/api/agents/architect/route.ts` - AI ä»£ç†æ¶æ§‹å¸«å¯¦ä½œ

---

---

## âœ… å¯¦ä½œç‹€æ…‹

### Phase 1ï¼šç§»é™¤å‰ç«¯é¸æ“‡å™¨ âœ… å·²å®Œæˆ

- âœ… ç§»é™¤ `ToolSelector` å…ƒä»¶
- âœ… ç§»é™¤ `SkillSelector` å…ƒä»¶
- âœ… æ–°å¢ AI æ¨è–¦çš„å·¥å…·/æŠ€èƒ½å”¯è®€é¡¯ç¤ºå€å¡Š
- âœ… æ–°å¢ç©ºç‹€æ…‹æç¤ºï¼ˆå¼•å°ä½¿ç”¨è€…ä½¿ç”¨ AI ä»£ç†æ¶æ§‹å¸«ï¼‰

### Phase 2ï¼šå¢å¼· AI ä»£ç†æ¶æ§‹å¸« âœ… å·²å®Œæˆ

- âœ… æŸ¥è©¢ `mcp_servers` è¡¨ï¼ˆå«éŒ¯èª¤è™•ç†ï¼‰
- âœ… åœ¨ Prompt ä¸­åŠ å…¥ MCP Servers è³‡è¨Š
- âœ… æ›´æ–° MCP é…ç½®å»ºè­°èªªæ˜

### Phase 3ï¼šè³‡æ–™åº«æ“´å…… âœ… å·²å®Œæˆ

- âœ… å»ºç«‹ `mcp_servers` è³‡æ–™è¡¨ Migration
- âœ… è¨­å®š RLS æ”¿ç­–ï¼ˆSUPER_ADMIN å¯ç®¡ç†ï¼Œæ‰€æœ‰ä½¿ç”¨è€…å¯è®€å–ï¼‰
- âœ… æ–°å¢ç´¢å¼•èˆ‡è§¸ç™¼å™¨

### Phase 4ï¼šç³»çµ±å±¤ç´šç®¡ç†ä»‹é¢ âœ… å·²å®Œæˆ

- âœ… å»ºç«‹ MCP Servers API ç«¯é» (`/api/system/mcp-servers`)
  - GETï¼šå–å¾—æ‰€æœ‰ MCP Servers
  - POSTï¼šå»ºç«‹æ–°çš„ MCP Server
  - PUTï¼šæ›´æ–° MCP Server
  - DELETEï¼šåˆªé™¤ MCP Server
- âœ… å»ºç«‹ MCPSkillsConfig ç®¡ç†å…ƒä»¶
  - MCP Servers åˆ—è¡¨é¡¯ç¤º
  - æ–°å¢/ç·¨è¼¯/åˆªé™¤ MCP Server
  - Capabilities ç®¡ç†
  - API Key ç®¡ç†ï¼ˆå«åŠ å¯†é¡¯ç¤ºï¼‰
- âœ… åœ¨ç³»çµ±è¨­å®šé é¢æ•´åˆ MCPSkillsConfig
  - ä½æ–¼ `/dashboard/admin/system` é é¢
  - èˆ‡å…¶ä»–ç³»çµ±è¨­å®šä¸¦åˆ—é¡¯ç¤º

---

## ğŸ“ å¯¦ä½œç´°ç¯€

### MCP Servers API (`/api/system/mcp-servers`)

**åŠŸèƒ½**ï¼š
- å®Œæ•´çš„ CRUD æ“ä½œ
- æ¬Šé™æª¢æŸ¥ï¼ˆåƒ… SUPER_ADMIN å¯ç®¡ç†ï¼‰
- éŒ¯èª¤è™•ç†èˆ‡é©—è­‰
- Capabilities é™£åˆ—æ ¼å¼é©—è­‰

**è³‡æ–™çµæ§‹**ï¼š
```typescript
interface MCPServer {
    id: string;
    name: string;              // å”¯ä¸€è­˜åˆ¥åï¼Œç”¨æ–¼ç¨‹å¼ç¢¼ä¸­å¼•ç”¨
    display_name: string;      // é¡¯ç¤ºåç¨±
    description?: string;      // æè¿°
    server_url: string;        // MCP Server URL
    server_type: 'http' | 'websocket' | 'stdio';
    api_key?: string;          // API Keyï¼ˆåŠ å¯†å„²å­˜ï¼‰
    capabilities: string[];    // èƒ½åŠ›åˆ—è¡¨
    is_active: boolean;        // æ˜¯å¦å•Ÿç”¨
    last_health_check?: string; // æœ€å¾Œå¥åº·æª¢æŸ¥æ™‚é–“
    created_at: string;
    updated_at: string;
}
```

### MCPSkillsConfig å…ƒä»¶

**åŠŸèƒ½**ï¼š
- åˆ—è¡¨é¡¯ç¤ºæ‰€æœ‰ MCP Servers
- æ–°å¢ MCP Serverï¼ˆè¡¨å–®é©—è­‰ï¼‰
- ç·¨è¼¯ MCP Serverï¼ˆä¸å¯ä¿®æ”¹ nameï¼‰
- åˆªé™¤ MCP Serverï¼ˆå«ç¢ºèªå°è©±æ¡†ï¼‰
- Capabilities å‹•æ…‹ç®¡ç†ï¼ˆæ–°å¢/ç§»é™¤ï¼‰
- API Key å®‰å…¨è¼¸å…¥ï¼ˆå¯†ç¢¼é®ç½©ï¼‰
- ç‹€æ…‹ç®¡ç†ï¼ˆå•Ÿç”¨/åœç”¨ï¼‰

**UI ç‰¹è‰²**ï¼š
- å¡ç‰‡å¼åˆ—è¡¨é¡¯ç¤º
- Modal è¡¨å–®ç·¨è¼¯
- å³æ™‚éŒ¯èª¤/æˆåŠŸè¨Šæ¯
- éŸ¿æ‡‰å¼è¨­è¨ˆ

---

**æ–‡ä»¶ç‰ˆæœ¬**ï¼šv1.2  
**æœ€å¾Œæ›´æ–°**ï¼š2026-01-17  
**ç‹€æ…‹**ï¼šPhase 1-4 å…¨éƒ¨å®Œæˆ âœ…
