# Pre-commit Hook èªªæ˜ï¼ˆç™½è©±ç‰ˆï¼‰

## ğŸ¤” é€™æ˜¯ä»€éº¼ï¼Ÿ

ç°¡å–®èªªï¼š**åœ¨ä½ æŠŠç¨‹å¼ç¢¼ commit åˆ° Git ä¹‹å‰ï¼Œè‡ªå‹•å¹«ä½ æª¢æŸ¥å’Œä¿®å¾©**

---

## ğŸ“ å¯¦éš›é‹ä½œæµç¨‹

### æƒ…æ³ 1ï¼šä½ ä¿®æ”¹äº†ä¸€å€‹æª”æ¡ˆ

å‡è¨­ä½ ä¿®æ”¹äº† `app/api/agents/route.ts`ï¼š

```typescript
// ä½ ä¿®æ”¹å¾Œçš„ç¨‹å¼ç¢¼
let agents = [];

// ä½ æƒ³è¦ commit
git add app/api/agents/route.ts
git commit -m "æ–°å¢åŠŸèƒ½"
```

**Pre-commit Hook æœƒè‡ªå‹•åŸ·è¡Œï¼š**

1. âœ… æª¢æŸ¥ `app/api/agents/route.ts`ï¼ˆåªæœ‰é€™å€‹æª”æ¡ˆï¼‰
2. âœ… ç™¼ç¾å•é¡Œï¼š`let agents = []` æ‡‰è©²æ”¹æˆ `const agents = []`
3. âœ… **è‡ªå‹•ä¿®å¾©**ï¼šæŠŠ `let` æ”¹æˆ `const`
4. âœ… ç¹¼çºŒ commit

**çµæœï¼š** ä½ ä»€éº¼éƒ½ä¸ç”¨åšï¼Œç¨‹å¼ç¢¼è‡ªå‹•ä¿®å¥½äº†ï¼Œç„¶å¾Œ commit æˆåŠŸï¼

---

### æƒ…æ³ 2ï¼šç„¡æ³•è‡ªå‹•ä¿®å¾©çš„å•é¡Œ

å‡è¨­ä½ ä¿®æ”¹äº† `app/api/chat/route.ts`ï¼š

```typescript
// ä½ ä¿®æ”¹å¾Œçš„ç¨‹å¼ç¢¼
function handleMessage(data: any) {  // é€™è£¡æœ‰ any
  // ...
}
```

**Pre-commit Hook æœƒè‡ªå‹•åŸ·è¡Œï¼š**

1. âœ… æª¢æŸ¥ `app/api/chat/route.ts`
2. âš ï¸ ç™¼ç¾å•é¡Œï¼šä½¿ç”¨äº† `any` å‹åˆ¥
3. âŒ **ç„¡æ³•è‡ªå‹•ä¿®å¾©**ï¼ˆå› ç‚º ESLint ä¸çŸ¥é“è©²æ”¹æˆä»€éº¼å‹åˆ¥ï¼‰
4. âš ï¸ é¡¯ç¤ºè­¦å‘Šè¨Šæ¯ï¼Œä½†**ä¸æœƒé˜»æ­¢ commit**ï¼ˆå› ç‚ºæ˜¯ `warn`ï¼Œä¸æ˜¯ `error`ï¼‰
5. âœ… ç¹¼çºŒ commit

**çµæœï¼š** ä½ çš„ commit æœƒæˆåŠŸï¼Œä½†æœƒçœ‹åˆ°è­¦å‘Šè¨Šæ¯æé†’ä½ é€™è£¡æœ‰å•é¡Œã€‚

---

## ğŸ¯ é‡é»æ•´ç†

### âœ… æœƒè‡ªå‹•ä¿®å¾©çš„å•é¡Œ

- `let` æ”¹æˆ `const`ï¼ˆå¦‚æœè®Šæ•¸æ²’æœ‰è¢«é‡æ–°è³¦å€¼ï¼‰
- æœªä½¿ç”¨çš„ importï¼ˆè‡ªå‹•åˆªé™¤ï¼‰
- æ ¼å¼å•é¡Œï¼ˆç©ºæ ¼ã€æ›è¡Œç­‰ï¼‰

### âš ï¸ ä¸æœƒè‡ªå‹•ä¿®å¾©ï¼ˆä½†æœƒé¡¯ç¤ºè­¦å‘Šï¼‰

- `any` å‹åˆ¥ï¼ˆä¸çŸ¥é“è©²æ”¹æˆä»€éº¼ï¼‰
- è¤‡é›œçš„é‚è¼¯éŒ¯èª¤
- éœ€è¦ä½ æ‰‹å‹•åˆ¤æ–·çš„å•é¡Œ

### ğŸ“Œ é‡è¦ï¼š**åªæª¢æŸ¥ä½ ä¿®æ”¹çš„æª”æ¡ˆ**

- âŒ **ä¸æœƒ**æª¢æŸ¥æ‰€æœ‰ 373 å€‹è­¦å‘Š
- âœ… **åªæœƒ**æª¢æŸ¥ä½ é€™æ¬¡ä¿®æ”¹çš„æª”æ¡ˆ
- âœ… æ‰€ä»¥ä¸æœƒå¾ˆæ…¢ï¼Œä¹Ÿä¸æœƒå½±éŸ¿å…¶ä»–æª”æ¡ˆ

---

## ğŸ” å¯¦éš›ç¯„ä¾‹

### ç¯„ä¾‹ 1ï¼šç°¡å–®çš„è‡ªå‹•ä¿®å¾©

**ä½ ä¿®æ”¹çš„ç¨‹å¼ç¢¼ï¼š**
```typescript
let name = "æ¸¬è©¦";
console.log(name);
```

**Commit æ™‚è‡ªå‹•è®Šæˆï¼š**
```typescript
const name = "æ¸¬è©¦";  // let è‡ªå‹•æ”¹æˆ const
console.log(name);
```

**ä½ çœ‹åˆ°ï¼š**
```
âœ” lint-staged: running eslint --fix
âœ” lint-staged: passing
[main abc123] æ–°å¢åŠŸèƒ½
```

---

### ç¯„ä¾‹ 2ï¼šç„¡æ³•è‡ªå‹•ä¿®å¾©çš„è­¦å‘Š

**ä½ ä¿®æ”¹çš„ç¨‹å¼ç¢¼ï¼š**
```typescript
function processData(data: any) {
  return data.value;
}
```

**Commit æ™‚ï¼š**
- âœ… Commit æˆåŠŸ
- âš ï¸ ä½†æœƒçœ‹åˆ°è­¦å‘Šï¼š

```
âš  Warning: Unexpected any. Specify a different type.
  app/api/chat/route.ts:10:23
```

**ä½ å¯ä»¥é¸æ“‡ï¼š**
- ç¾åœ¨å°±ä¿®å¾©å®ƒ
- æˆ–ä¹‹å¾Œå†ä¿®å¾©ï¼ˆä¸æœƒé˜»æ­¢ä½ çš„å·¥ä½œï¼‰

---

## ğŸ’¡ ç‚ºä»€éº¼é€™æ¨£è¨­è¨ˆï¼Ÿ

### âŒ ä¸å¥½çš„æ–¹å¼ï¼ˆæœƒå¡ä½ä½ ï¼‰

```bash
# å‡è¨­æª¢æŸ¥æ‰€æœ‰ 373 å€‹è­¦å‘Šæ‰è®“ commit
# ä½ æ¯æ¬¡ commit éƒ½è¦ç­‰å¾ˆä¹…ï¼Œè€Œä¸”å¾ˆå¤šè­¦å‘Šè·Ÿä½ ç„¡é—œ
git commit -m "ä¿®å¾©å° bug"
# âŒ éŒ¯èª¤ï¼šç™¼ç¾ 373 å€‹è­¦å‘Šï¼Œè«‹å…ˆä¿®å¾©æ‰€æœ‰è­¦å‘Š
# ğŸ˜± ä½†é€™äº›è­¦å‘Šä¸æ˜¯ä½ é€ æˆçš„ï¼
```

### âœ… å¥½çš„æ–¹å¼ï¼ˆåªæª¢æŸ¥ä½ æ”¹çš„ï¼‰

```bash
# åªæª¢æŸ¥ä½ ä¿®æ”¹çš„æª”æ¡ˆ
git commit -m "ä¿®å¾©å° bug"
# âœ… åªæª¢æŸ¥ä½ æ”¹çš„ 1 å€‹æª”æ¡ˆ
# âœ… è‡ªå‹•ä¿®å¾©ç°¡å–®çš„å•é¡Œ
# âœ… Commit æˆåŠŸï¼Œç¹¼çºŒå·¥ä½œ
```

---

## ğŸ¯ ç¸½çµ

**Pre-commit Hook çš„ä½œç”¨ï¼š**

1. âœ… **è‡ªå‹•ä¿®å¾©ç°¡å–®å•é¡Œ**ï¼ˆå¦‚ `let` â†’ `const`ï¼‰
2. âš ï¸ **æé†’ä½ è¤‡é›œå•é¡Œ**ï¼ˆå¦‚ `any` å‹åˆ¥ï¼‰
3. ğŸ“Œ **åªæª¢æŸ¥ä½ ä¿®æ”¹çš„æª”æ¡ˆ**ï¼ˆä¸æœƒå½±éŸ¿å…¶ä»–æª”æ¡ˆï¼‰
4. ğŸš€ **ä¸é˜»æ­¢ä½ çš„å·¥ä½œ**ï¼ˆè­¦å‘Šä¸æœƒé˜»æ­¢ commitï¼‰

**ä½ ä¸éœ€è¦åšä»»ä½•é¡å¤–çš„äº‹æƒ…ï¼Œå®ƒæœƒè‡ªå‹•åœ¨èƒŒæ™¯é‹ä½œï¼**

---

## ğŸ”§ å¦‚æœæƒ³æ¸¬è©¦

```bash
# 1. ä¿®æ”¹ä¸€å€‹æª”æ¡ˆï¼ˆä¾‹å¦‚åŠ ä¸Š letï¼‰
echo 'let test = "hello";' >> app/api/test.ts

# 2. å˜—è©¦ commit
git add app/api/test.ts
git commit -m "æ¸¬è©¦"

# 3. ä½ æœƒçœ‹åˆ° pre-commit hook è‡ªå‹•åŸ·è¡Œ
# 4. å¦‚æœ let å¯ä»¥æ”¹æˆ constï¼Œæœƒè‡ªå‹•ä¿®å¾©
# 5. Commit æˆåŠŸ
```

---

**ç°¡å–®è¨˜ä½ï¼šå°±åƒä¸€å€‹è‡ªå‹•æ ¡å°å·¥å…·ï¼Œåœ¨ä½ æäº¤å‰å¹«ä½ æª¢æŸ¥å’Œä¿®å¾©ï¼**
