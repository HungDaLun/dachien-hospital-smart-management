# èªéŸ³ AI åŠ©ç†æŠ€è¡“è½åœ°æ–¹æ¡ˆï¼šLiveKit + Gemini 3

**ç‰ˆæœ¬**ï¼šv1.0
**å»ºç«‹æ—¥æœŸ**ï¼š2026-01-17
**æ–¹æ¡ˆä»£è™Ÿ**ï¼šæ–¹æ¡ˆ C
**é ä¼°é–‹ç™¼æ™‚é–“**ï¼š2-3 é€±
**é ä¼°æœˆæˆæœ¬**ï¼š$28-50 USDï¼ˆç´„ NTD 900-1,600ï¼‰

---

## ğŸ“‹ åŸ·è¡Œæ‘˜è¦

æœ¬æ–‡ä»¶è©³ç´°è¦åŠƒå¦‚ä½•å°‡ã€ŒèªéŸ³ AI åŠ©ç†ã€åŠŸèƒ½æ•´åˆåˆ°ç¾æœ‰çš„çŸ¥è­˜æ¶æ§‹ç³»çµ±ä¸­ï¼Œæ¡ç”¨ **LiveKit + Gemini 3 Flash** æ–¹æ¡ˆï¼Œå¯¦ç¾ï¼š

1. **èªéŸ³è¼¸å…¥**ï¼šä¼æ¥­ä¸»å¯ç”¨èªéŸ³è©¢å•å•é¡Œ
2. **æ™ºæ…§å›æ‡‰**ï¼šè¤‡ç”¨ç¾æœ‰ Agent é‚è¼¯èˆ‡çŸ¥è­˜åº«
3. **èªéŸ³è¼¸å‡º**ï¼šAI ç”¨è‡ªç„¶èªéŸ³å›ç­”
4. **è¦–è¦ºåé¥‹**ï¼šæ•¸ä½å…‰çƒéš¨èªéŸ³å¾‹å‹•
5. **å®Œæ•´æ•´åˆ**ï¼šå°è©±è¨˜éŒ„å­˜å…¥ç¾æœ‰ Supabaseï¼Œèˆ‡æ–‡å­—å°è©±ç³»çµ±çµ±ä¸€

### ç‚ºä»€éº¼é¸æ“‡æ­¤æ–¹æ¡ˆ

| å„ªå‹¢ | èªªæ˜ |
|-----|------|
| **çŸ¥è­˜åº«æ·±åº¦æ•´åˆ** | ç›´æ¥å‘¼å«ç¾æœ‰ `/api/chat`ï¼Œè¤‡ç”¨ DIKW åˆ†é¡ã€èªç¾©æœå°‹ã€çŸ¥è­˜è¡°æ¸›æ¨¡å‹ |
| **Agent ä¸€è‡´æ€§** | ä½¿ç”¨ç¾æœ‰ Agent çš„ System Prompt å’Œå€‹æ€§è¨­å®š |
| **æ•¸æ“šå®Œæ•´æ€§** | èªéŸ³å°è©±å­˜å…¥åŒä¸€å€‹ Supabaseï¼Œå¯çµ±ä¸€åˆ†æ |
| **æˆæœ¬æ•ˆç›Š** | LLM ä½¿ç”¨ç¾æœ‰ Gemini é¡åº¦ï¼Œæœˆæˆæœ¬åƒ… ~$28 |
| **å¯å‡ç´šæ€§** | æœªä¾†å¯ç„¡ç¸«å‡ç´šåˆ° OpenAI Realtime API |

---

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

### æ•´é«”æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         èªéŸ³ AI åŠ©ç†ç³»çµ±æ¶æ§‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                        å‰ç«¯ (Next.js)                               â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚    â”‚
â”‚   â”‚  â”‚  å…‰çƒè¦–è¦ºåŒ–  â”‚  â”‚  éº¥å…‹é¢¨æ§åˆ¶  â”‚  â”‚  å°è©±é¡¯ç¤º   â”‚                 â”‚    â”‚
â”‚   â”‚  â”‚  (Three.js) â”‚  â”‚  (WebRTC)   â”‚  â”‚  (React)   â”‚                 â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚    â”‚
â”‚   â”‚                         â”‚                                           â”‚    â”‚
â”‚   â”‚                         â–¼                                           â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚   â”‚  â”‚              @livekit/components-react                       â”‚   â”‚    â”‚
â”‚   â”‚  â”‚              â€¢ useVoiceAssistant()                          â”‚   â”‚    â”‚
â”‚   â”‚  â”‚              â€¢ RoomAudioRenderer                            â”‚   â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼ WebRTC                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                      LiveKit Cloud                                  â”‚    â”‚
â”‚   â”‚  â€¢ å³æ™‚éŸ³è¨Šä¸²æµç®¡ç†                                                  â”‚    â”‚
â”‚   â”‚  â€¢ å›éŸ³æ¶ˆé™¤ã€å™ªéŸ³æŠ‘åˆ¶                                                â”‚    â”‚
â”‚   â”‚  â€¢ ç¶²çµ¡æŠ–å‹•è™•ç†                                                     â”‚    â”‚
â”‚   â”‚  â€¢ æ–·ç·šè‡ªå‹•é‡é€£                                                     â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                    LiveKit Agent (Python)                           â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚   â”‚  â”‚                     èªéŸ³è™•ç† Pipeline                         â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  VAD    â”‚â”€â”€â”€â–¶â”‚  STT    â”‚â”€â”€â”€â–¶â”‚  LLM    â”‚â”€â”€â”€â–¶â”‚  TTS    â”‚   â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â”‚ Silero  â”‚    â”‚Deepgram â”‚    â”‚ (HTTP)  â”‚    â”‚ Google  â”‚   â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚   â”‚                              â”‚                                      â”‚    â”‚
â”‚   â”‚                              â–¼ HTTP POST                            â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚   â”‚  â”‚                    Tool Functions                             â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ chat_with_agent() â”€â”€â–¶ /api/chat                           â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ query_kpi() â”€â”€â–¶ /api/war-room/kpi/*                       â”‚  â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ search_knowledge() â”€â”€â–¶ /api/knowledge/search              â”‚  â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                    æ‚¨çš„ç¾æœ‰ç³»çµ± (Next.js)                           â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚    â”‚
â”‚   â”‚  â”‚ /api/chat   â”‚  â”‚/api/war-roomâ”‚  â”‚/api/knowledgeâ”‚                â”‚    â”‚
â”‚   â”‚  â”‚ (å°è©± API)  â”‚  â”‚  (æˆ°æƒ…å®¤)   â”‚  â”‚  (çŸ¥è­˜åº«)   â”‚                 â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚    â”‚
â”‚   â”‚                         â”‚                                           â”‚    â”‚
â”‚   â”‚                         â–¼                                           â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚   â”‚  â”‚                    Supabase                                  â”‚   â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ chat_sessions (å°è©±è¨˜éŒ„)                                  â”‚   â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ chat_messages (è¨Šæ¯å…§å®¹)                                  â”‚   â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ files (çŸ¥è­˜åº«)                                           â”‚   â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ agents (Agent è¨­å®š)                                      â”‚   â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è³‡æ–™æµç¨‹

```
1. ä½¿ç”¨è€…å°éº¥å…‹é¢¨èªªè©±
       â”‚
       â–¼
2. ç€è¦½å™¨é€é WebRTC ä¸²æµåˆ° LiveKit Cloud
       â”‚
       â–¼
3. LiveKit Cloud è½‰ç™¼åˆ° LiveKit Agent
       â”‚
       â–¼
4. Agent Pipeline:
   a. VAD (Silero) åµæ¸¬äººè²çµæŸ
   b. STT (Deepgram) èªéŸ³è½‰æ–‡å­—
   c. å‘¼å«æ‚¨çš„ /api/chatï¼ˆå¸¶å…¥ Agent IDã€Session IDï¼‰
   d. æ‚¨çš„ API åŸ·è¡ŒçŸ¥è­˜åº«æœå°‹ã€ç”Ÿæˆå›æ‡‰
   e. TTS (Google) æ–‡å­—è½‰èªéŸ³
       â”‚
       â–¼
5. éŸ³è¨Šä¸²æµå›ç€è¦½å™¨æ’­æ”¾
       â”‚
       â–¼
6. å…‰çƒè¦–è¦ºåŒ–éš¨éŸ³è¨Šæ³¢å‹•
```

---

## ğŸ“ å°ˆæ¡ˆçµæ§‹

### æ–°å¢æª”æ¡ˆæ¸…å–®

```
çŸ¥è­˜æ¶æ§‹å¸«/
â”œâ”€â”€ voice-agent/                          # æ–°å¢ï¼šPython LiveKit Agent
â”‚   â”œâ”€â”€ agent.py                          # Agent ä¸»ç¨‹å¼
â”‚   â”œâ”€â”€ tools.py                          # å·¥å…·å‡½æ•¸ï¼ˆå‘¼å«æ‚¨çš„ APIï¼‰
â”‚   â”œâ”€â”€ config.py                         # è¨­å®šæª”
â”‚   â”œâ”€â”€ requirements.txt                  # Python ä¾è³´
â”‚   â”œâ”€â”€ Dockerfile                        # å®¹å™¨åŒ–éƒ¨ç½²
â”‚   â””â”€â”€ README.md                         # Agent èªªæ˜æ–‡ä»¶
â”‚
â”œâ”€â”€ app/
â”‚   â””â”€â”€ [locale]/
â”‚       â””â”€â”€ (dashboard)/
â”‚           â””â”€â”€ voice-assistant/          # æ–°å¢ï¼šèªéŸ³åŠ©ç†é é¢
â”‚               â”œâ”€â”€ page.tsx              # ä¸»é é¢
â”‚               â””â”€â”€ components/
â”‚                   â”œâ”€â”€ VoiceOrb.tsx      # å…‰çƒè¦–è¦ºåŒ–å…ƒä»¶
â”‚                   â”œâ”€â”€ VoiceControls.tsx # éº¥å…‹é¢¨æ§åˆ¶
â”‚                   â””â”€â”€ TranscriptPanel.tsx # å°è©±é¡¯ç¤º
â”‚
â”œâ”€â”€ app/api/
â”‚   â””â”€â”€ voice/
â”‚       â”œâ”€â”€ token/route.ts                # æ–°å¢ï¼šLiveKit Token API
â”‚       â””â”€â”€ webhook/route.ts              # æ–°å¢ï¼šAgent å›èª¿ APIï¼ˆå¯é¸ï¼‰
â”‚
â”œâ”€â”€ components/
â”‚   â””â”€â”€ voice/
â”‚       â”œâ”€â”€ VoiceAssistantButton.tsx      # æ–°å¢ï¼šå…¨åŸŸèªéŸ³æŒ‰éˆ•
â”‚       â””â”€â”€ VoiceModal.tsx                # æ–°å¢ï¼šèªéŸ³å°è©± Modal
â”‚
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ livekit/
â”‚       â”œâ”€â”€ client.ts                     # æ–°å¢ï¼šLiveKit å®¢æˆ¶ç«¯å·¥å…·
â”‚       â””â”€â”€ config.ts                     # æ–°å¢ï¼šLiveKit è¨­å®š
â”‚
â””â”€â”€ docs/
    â””â”€â”€ VOICE_AI_IMPLEMENTATION_PLAN_C.md # æœ¬æ–‡ä»¶
```

---

## ğŸ”§ æŠ€è¡“å¯¦ä½œç´°ç¯€

### Phase 1ï¼šç’°å¢ƒå»ºç½®ï¼ˆ1 å¤©ï¼‰

#### 1.1 ç”³è«‹æœå‹™å¸³è™Ÿ

| æœå‹™ | ç”¨é€” | ç”³è«‹ç¶²å€ |
|-----|------|---------|
| **LiveKit Cloud** | å³æ™‚èªéŸ³ä¸²æµ | https://cloud.livekit.io |
| **Deepgram** | èªéŸ³è½‰æ–‡å­— (STT) | https://console.deepgram.com |
| **Google Cloud** | æ–‡å­—è½‰èªéŸ³ (TTS) | https://console.cloud.google.com |

#### 1.2 ç’°å¢ƒè®Šæ•¸è¨­å®š

```bash
# .env.local æ–°å¢

# LiveKit
LIVEKIT_API_KEY=your_livekit_api_key
LIVEKIT_API_SECRET=your_livekit_api_secret
LIVEKIT_URL=wss://your-app.livekit.cloud

# Deepgram
DEEPGRAM_API_KEY=your_deepgram_api_key

# Google Cloud TTS
GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json
# æˆ–ä½¿ç”¨ API Key
GOOGLE_TTS_API_KEY=your_google_tts_api_key

# Agent å…§éƒ¨é€šè¨Š
VOICE_AGENT_API_KEY=your_internal_api_key  # ç”¨æ–¼ Agent å‘¼å«æ‚¨çš„ API
VOICE_AGENT_BASE_URL=https://your-app.com  # æ‚¨çš„ Next.js æ‡‰ç”¨ç¶²å€
```

#### 1.3 å®‰è£ä¾è³´

**Next.js å‰ç«¯**

```bash
npm install @livekit/components-react livekit-client livekit-server-sdk
npm install three @react-three/fiber @react-three/drei
```

**Python Agent**

```bash
# voice-agent/requirements.txt

livekit-agents>=0.8.0
livekit-plugins-deepgram>=0.6.0
livekit-plugins-google>=0.6.0
livekit-plugins-silero>=0.6.0
aiohttp>=3.9.0
python-dotenv>=1.0.0
```

---

### Phase 2ï¼šLiveKit Agent é–‹ç™¼ï¼ˆ4-5 å¤©ï¼‰

#### 2.1 Agent ä¸»ç¨‹å¼

```python
# voice-agent/agent.py

import asyncio
import logging
from dotenv import load_dotenv

from livekit import rtc
from livekit.agents import (
    AutoSubscribe,
    JobContext,
    JobProcess,
    WorkerOptions,
    cli,
    llm,
)
from livekit.agents.pipeline import VoicePipelineAgent
from livekit.plugins import deepgram, google, silero

from tools import create_tools
from config import settings

load_dotenv()
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger("voice-agent")


def prewarm(proc: JobProcess):
    """é å…ˆè¼‰å…¥æ¨¡å‹ï¼Œæ¸›å°‘é¦–æ¬¡å°è©±å»¶é²"""
    proc.userdata["vad"] = silero.VAD.load()


async def entrypoint(ctx: JobContext):
    """Agent é€²å…¥é»"""

    # 1. é€£æ¥åˆ° LiveKit Room
    logger.info(f"Connecting to room: {ctx.room.name}")
    await ctx.connect(auto_subscribe=AutoSubscribe.AUDIO_ONLY)

    # 2. ç­‰å¾…ä½¿ç”¨è€…åŠ å…¥
    participant = await ctx.wait_for_participant()
    logger.info(f"Participant joined: {participant.identity}")

    # 3. å¾ participant metadata å–å¾—ä½¿ç”¨è€…è³‡è¨Š
    user_metadata = participant.metadata or "{}"
    import json
    user_info = json.loads(user_metadata)
    user_id = user_info.get("user_id", "unknown")
    agent_id = user_info.get("agent_id", settings.DEFAULT_AGENT_ID)

    # 4. å»ºç«‹å·¥å…·ï¼ˆé€£æ¥åˆ°æ‚¨çš„ APIï¼‰
    tools = create_tools(user_id=user_id, agent_id=agent_id)

    # 5. å»ºç«‹åˆå§‹å°è©±ä¸Šä¸‹æ–‡
    initial_ctx = llm.ChatContext()
    initial_ctx.append(
        role="system",
        text=f"""ä½ æ˜¯ä¼æ¥­ä¸»çš„ AI èªéŸ³ç‰¹åŠ©ï¼Œåå«ã€Œå°æ™ºã€ã€‚

## èº«ä»½èˆ‡è§’è‰²
- ä½ æ˜¯ä¸€ä½å°ˆæ¥­ã€é«˜æ•ˆçš„ä¼æ¥­ç§˜æ›¸
- ä½ å¯ä»¥å­˜å–å…¬å¸çš„çŸ¥è­˜åº«å’Œç‡Ÿé‹æ•¸æ“š
- ä½ çš„å›ç­”æ‡‰è©²ç°¡æ½”æœ‰åŠ›ï¼Œé©åˆèªéŸ³å°è©±

## èªªè©±é¢¨æ ¼
- æ¯æ¬¡å›ç­”æ§åˆ¶åœ¨ 3-5 å¥è©±å…§
- é‡è¦æ•¸å­—è¦æ¸…æ¥šå”¸å‡º
- èªæ°£å°ˆæ¥­ä½†è¦ªåˆ‡
- é¿å…ä½¿ç”¨ Markdown æ ¼å¼ï¼ˆé€™æ˜¯èªéŸ³å°è©±ï¼‰

## å¯ç”¨å·¥å…·
- chat_with_agent: æŸ¥è©¢çŸ¥è­˜åº«ã€å›ç­”è¤‡é›œå•é¡Œ
- query_revenue: æŸ¥è©¢ç‡Ÿæ”¶æ•¸æ“š
- query_risks: æŸ¥è©¢é¢¨éšªé è­¦
- search_knowledge: æœå°‹ç‰¹å®šçŸ¥è­˜

## é–‹å ´ç™½
ç”¨è¦ªåˆ‡çš„æ–¹å¼æ‰“æ‹›å‘¼ï¼Œè©¢å•æœ‰ä»€éº¼å¯ä»¥å¹«å¿™çš„ã€‚
"""
    )

    # 6. å»ºç«‹èªéŸ³ Pipeline Agent
    agent = VoicePipelineAgent(
        vad=ctx.proc.userdata["vad"],
        stt=deepgram.STT(
            model="nova-2",
            language="zh-TW",
        ),
        llm=llm.LLM.with_google(
            model="gemini-2.0-flash",  # ä½¿ç”¨ Gemini
        ),
        tts=google.TTS(
            language="zh-TW",
            gender="female",
            voice_name="zh-TW-Wavenet-A",
        ),
        chat_ctx=initial_ctx,
        fnc_ctx=tools,
    )

    # 7. è¨­å®šäº‹ä»¶è™•ç†
    @agent.on("user_speech_committed")
    def on_user_speech(msg: llm.ChatMessage):
        """ä½¿ç”¨è€…èªªå®Œè©±æ™‚è§¸ç™¼"""
        logger.info(f"User said: {msg.content}")

    @agent.on("agent_speech_committed")
    def on_agent_speech(msg: llm.ChatMessage):
        """Agent èªªå®Œè©±æ™‚è§¸ç™¼"""
        logger.info(f"Agent said: {msg.content}")

    @agent.on("function_calls_collected")
    def on_function_calls(calls: list[llm.FunctionCallInfo]):
        """å·¥å…·èª¿ç”¨æ™‚è§¸ç™¼"""
        for call in calls:
            logger.info(f"Calling function: {call.function_info.name}")

    # 8. å•Ÿå‹• Agent
    agent.start(ctx.room, participant)

    # 9. æ’­æ”¾é–‹å ´ç™½
    await agent.say(
        "æ‚¨å¥½ï¼Œæˆ‘æ˜¯æ‚¨çš„ AI ç‰¹åŠ©å°æ™ºã€‚æœ‰ä»€éº¼æˆ‘å¯ä»¥å¹«æ‚¨çš„å—ï¼Ÿ",
        allow_interruptions=True,
    )


if __name__ == "__main__":
    cli.run_app(
        WorkerOptions(
            entrypoint_fnc=entrypoint,
            prewarm_fnc=prewarm,
        ),
    )
```

#### 2.2 å·¥å…·å‡½æ•¸

```python
# voice-agent/tools.py

import aiohttp
from livekit.agents import llm

from config import settings


def create_tools(user_id: str, agent_id: str) -> llm.FunctionContext:
    """å»ºç«‹ Agent å¯ç”¨çš„å·¥å…·"""

    fnc_ctx = llm.FunctionContext()

    @fnc_ctx.ai_callable(
        description="æŸ¥è©¢çŸ¥è­˜åº«ä¸¦å›ç­”å•é¡Œã€‚ç•¶ä½¿ç”¨è€…è©¢å•å…¬å¸ç›¸é—œå•é¡Œæ™‚ä½¿ç”¨æ­¤å·¥å…·ã€‚"
    )
    async def chat_with_agent(
        question: str = llm.TypeInfo(description="ä½¿ç”¨è€…çš„å•é¡Œ"),
    ) -> str:
        """å‘¼å«æ‚¨ç¾æœ‰çš„ /api/chat"""
        async with aiohttp.ClientSession() as session:
            async with session.post(
                f"{settings.BASE_URL}/api/chat",
                json={
                    "message": question,
                    "agent_id": agent_id,
                    "mode": "voice",  # å‘Šè¨´ API ç”¨ç°¡çŸ­å›æ‡‰
                },
                headers={
                    "Authorization": f"Bearer {settings.API_KEY}",
                    "X-User-Id": user_id,
                },
            ) as response:
                if response.status == 200:
                    data = await response.json()
                    return data.get("reply", "æŠ±æ­‰ï¼Œæˆ‘ç„¡æ³•å–å¾—å›æ‡‰ã€‚")
                else:
                    return "æŠ±æ­‰ï¼Œç³»çµ±æš«æ™‚ç„¡æ³•è™•ç†æ‚¨çš„è«‹æ±‚ã€‚"

    @fnc_ctx.ai_callable(
        description="æŸ¥è©¢å…¬å¸ç‡Ÿæ”¶å’Œè²¡å‹™æ•¸æ“š"
    )
    async def query_revenue(
        period: str = llm.TypeInfo(
            description="æ™‚é–“ç¯„åœï¼štoday, this_week, this_month, this_quarter"
        ),
    ) -> str:
        """å‘¼å«æˆ°æƒ…å®¤ API"""
        async with aiohttp.ClientSession() as session:
            async with session.get(
                f"{settings.BASE_URL}/api/war-room/kpi/financial",
                params={"period": period},
                headers={
                    "Authorization": f"Bearer {settings.API_KEY}",
                    "X-User-Id": user_id,
                },
            ) as response:
                if response.status == 200:
                    data = await response.json()
                    revenue = data.get("revenue", 0)
                    achievement = data.get("achievement_rate", 0)
                    trend = data.get("trend", "stable")

                    trend_text = {
                        "up": "ä¸Šå‡",
                        "down": "ä¸‹é™",
                        "stable": "æŒå¹³"
                    }.get(trend, "æŒå¹³")

                    return f"ç‡Ÿæ”¶ç‚º {revenue:,.0f} å…ƒï¼Œé”æˆç‡ {achievement:.1f}%ï¼Œè¶¨å‹¢{trend_text}ã€‚"
                else:
                    return "æŠ±æ­‰ï¼Œç„¡æ³•å–å¾—è²¡å‹™æ•¸æ“šã€‚"

    @fnc_ctx.ai_callable(
        description="æŸ¥è©¢ç›®å‰çš„é¢¨éšªé è­¦"
    )
    async def query_risks() -> str:
        """å‘¼å«é¢¨éšªé è­¦ API"""
        async with aiohttp.ClientSession() as session:
            async with session.get(
                f"{settings.BASE_URL}/api/war-room/kpi/risks",
                headers={
                    "Authorization": f"Bearer {settings.API_KEY}",
                    "X-User-Id": user_id,
                },
            ) as response:
                if response.status == 200:
                    data = await response.json()
                    risks = data.get("risks", [])

                    if not risks:
                        return "ç›®å‰æ²’æœ‰é‡å¤§é¢¨éšªé è­¦ã€‚"

                    # åªå›å ±å‰ 3 å€‹æœ€é‡è¦çš„é¢¨éšª
                    top_risks = risks[:3]
                    risk_summary = "ã€‚".join([
                        f"{r.get('title', 'æœªçŸ¥é¢¨éšª')}"
                        for r in top_risks
                    ])

                    return f"ç›®å‰æœ‰ {len(risks)} é …é¢¨éšªéœ€è¦é—œæ³¨ã€‚æœ€é‡è¦çš„æ˜¯ï¼š{risk_summary}ã€‚"
                else:
                    return "æŠ±æ­‰ï¼Œç„¡æ³•å–å¾—é¢¨éšªè³‡è¨Šã€‚"

    @fnc_ctx.ai_callable(
        description="åœ¨çŸ¥è­˜åº«ä¸­æœå°‹ç‰¹å®šè³‡è¨Š"
    )
    async def search_knowledge(
        query: str = llm.TypeInfo(description="æœå°‹é—œéµå­—"),
    ) -> str:
        """å‘¼å«çŸ¥è­˜åº«æœå°‹ API"""
        async with aiohttp.ClientSession() as session:
            async with session.post(
                f"{settings.BASE_URL}/api/knowledge/search",
                json={"query": query, "limit": 3},
                headers={
                    "Authorization": f"Bearer {settings.API_KEY}",
                    "X-User-Id": user_id,
                },
            ) as response:
                if response.status == 200:
                    data = await response.json()
                    results = data.get("results", [])

                    if not results:
                        return f"æ²’æœ‰æ‰¾åˆ°é—œæ–¼ã€Œ{query}ã€çš„ç›¸é—œè³‡æ–™ã€‚"

                    # çµ„åˆæœå°‹çµæœæ‘˜è¦
                    summaries = []
                    for r in results[:3]:
                        title = r.get("filename", "æœªçŸ¥æ–‡ä»¶")
                        snippet = r.get("snippet", "")[:100]
                        summaries.append(f"{title}ï¼š{snippet}")

                    return f"æ‰¾åˆ° {len(results)} ç­†ç›¸é—œè³‡æ–™ã€‚" + "ã€‚".join(summaries)
                else:
                    return "æŠ±æ­‰ï¼Œæœå°‹æ™‚ç™¼ç”ŸéŒ¯èª¤ã€‚"

    return fnc_ctx
```

#### 2.3 è¨­å®šæª”

```python
# voice-agent/config.py

import os
from dataclasses import dataclass


@dataclass
class Settings:
    # LiveKit
    LIVEKIT_URL: str = os.getenv("LIVEKIT_URL", "")
    LIVEKIT_API_KEY: str = os.getenv("LIVEKIT_API_KEY", "")
    LIVEKIT_API_SECRET: str = os.getenv("LIVEKIT_API_SECRET", "")

    # Deepgram
    DEEPGRAM_API_KEY: str = os.getenv("DEEPGRAM_API_KEY", "")

    # Google TTS
    GOOGLE_TTS_API_KEY: str = os.getenv("GOOGLE_TTS_API_KEY", "")

    # Your API
    BASE_URL: str = os.getenv("VOICE_AGENT_BASE_URL", "http://localhost:3000")
    API_KEY: str = os.getenv("VOICE_AGENT_API_KEY", "")

    # Default Agent
    DEFAULT_AGENT_ID: str = os.getenv("DEFAULT_VOICE_AGENT_ID", "")


settings = Settings()
```

#### 2.4 Dockerfile

```dockerfile
# voice-agent/Dockerfile

FROM python:3.11-slim

WORKDIR /app

# å®‰è£ç³»çµ±ä¾è³´
RUN apt-get update && apt-get install -y \
    build-essential \
    && rm -rf /var/lib/apt/lists/*

# è¤‡è£½ä¾è³´æª”æ¡ˆ
COPY requirements.txt .

# å®‰è£ Python ä¾è³´
RUN pip install --no-cache-dir -r requirements.txt

# è¤‡è£½ç¨‹å¼ç¢¼
COPY . .

# è¨­å®šç’°å¢ƒè®Šæ•¸
ENV PYTHONUNBUFFERED=1

# å•Ÿå‹• Agent
CMD ["python", "agent.py", "start"]
```

---

### Phase 3ï¼šå‰ç«¯æ•´åˆï¼ˆ4-5 å¤©ï¼‰

#### 3.1 LiveKit Token API

```typescript
// app/api/voice/token/route.ts

import { AccessToken } from 'livekit-server-sdk';
import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@/lib/supabase/server';

export async function POST(request: NextRequest) {
    try {
        const supabase = await createClient();

        // é©—è­‰ä½¿ç”¨è€…
        const { data: { user }, error: authError } = await supabase.auth.getUser();
        if (authError || !user) {
            return NextResponse.json(
                { error: 'Unauthorized' },
                { status: 401 }
            );
        }

        // å–å¾—è«‹æ±‚åƒæ•¸
        const body = await request.json();
        const { agent_id } = body;

        // å–å¾—ä½¿ç”¨è€…è³‡æ–™
        const { data: profile } = await supabase
            .from('user_profiles')
            .select('display_name')
            .eq('id', user.id)
            .single();

        // å»ºç«‹ LiveKit Token
        const token = new AccessToken(
            process.env.LIVEKIT_API_KEY!,
            process.env.LIVEKIT_API_SECRET!,
            {
                identity: user.id,
                name: profile?.display_name || user.email || 'User',
                metadata: JSON.stringify({
                    user_id: user.id,
                    agent_id: agent_id || process.env.DEFAULT_VOICE_AGENT_ID,
                }),
            }
        );

        // è¨­å®šæ¬Šé™
        token.addGrant({
            room: `voice-assistant-${user.id}`,
            roomJoin: true,
            canPublish: true,
            canSubscribe: true,
            canPublishData: true,
        });

        // å›å‚³ Token
        return NextResponse.json({
            token: await token.toJwt(),
            url: process.env.LIVEKIT_URL,
            room: `voice-assistant-${user.id}`,
        });

    } catch (error) {
        console.error('[Voice Token] Error:', error);
        return NextResponse.json(
            { error: 'Failed to generate token' },
            { status: 500 }
        );
    }
}
```

#### 3.2 èªéŸ³åŠ©ç†ä¸»é é¢

```typescript
// app/[locale]/(dashboard)/voice-assistant/page.tsx

'use client';

import { useEffect, useState, useCallback } from 'react';
import {
    LiveKitRoom,
    useVoiceAssistant,
    BarVisualizer,
    RoomAudioRenderer,
    useConnectionState,
    useTracks,
} from '@livekit/components-react';
import { ConnectionState, Track } from 'livekit-client';
import { Mic, MicOff, Phone, PhoneOff } from 'lucide-react';

import VoiceOrb from './components/VoiceOrb';
import TranscriptPanel from './components/TranscriptPanel';

interface ConnectionInfo {
    token: string;
    url: string;
    room: string;
}

export default function VoiceAssistantPage() {
    const [connectionInfo, setConnectionInfo] = useState<ConnectionInfo | null>(null);
    const [isConnecting, setIsConnecting] = useState(false);
    const [error, setError] = useState<string | null>(null);

    // å–å¾— LiveKit Token
    const connect = useCallback(async () => {
        setIsConnecting(true);
        setError(null);

        try {
            const response = await fetch('/api/voice/token', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({}),
            });

            if (!response.ok) {
                throw new Error('Failed to get token');
            }

            const data = await response.json();
            setConnectionInfo(data);
        } catch (err) {
            setError('ç„¡æ³•é€£æ¥èªéŸ³æœå‹™ï¼Œè«‹ç¨å¾Œå†è©¦');
            console.error(err);
        } finally {
            setIsConnecting(false);
        }
    }, []);

    // æ–·é–‹é€£æ¥
    const disconnect = useCallback(() => {
        setConnectionInfo(null);
    }, []);

    return (
        <div className="min-h-screen bg-gradient-to-b from-slate-900 via-slate-950 to-black">
            {/* æ¨™é¡Œåˆ— */}
            <header className="p-6 border-b border-white/10">
                <div className="max-w-4xl mx-auto flex items-center justify-between">
                    <div>
                        <h1 className="text-2xl font-bold text-white">AI èªéŸ³ç‰¹åŠ©</h1>
                        <p className="text-sm text-gray-400 mt-1">
                            ç”¨èªéŸ³èˆ‡ AI å°è©±ï¼ŒæŸ¥è©¢å…¬å¸è³‡è¨Š
                        </p>
                    </div>

                    {/* é€£æ¥ç‹€æ…‹ */}
                    <div className="flex items-center gap-2">
                        <span className={`w-2 h-2 rounded-full ${
                            connectionInfo ? 'bg-green-500 animate-pulse' : 'bg-gray-500'
                        }`} />
                        <span className="text-sm text-gray-400">
                            {connectionInfo ? 'å·²é€£æ¥' : 'æœªé€£æ¥'}
                        </span>
                    </div>
                </div>
            </header>

            {/* ä¸»è¦å…§å®¹ */}
            <main className="flex-1 flex flex-col items-center justify-center p-6">
                {connectionInfo ? (
                    <LiveKitRoom
                        serverUrl={connectionInfo.url}
                        token={connectionInfo.token}
                        connect={true}
                        audio={true}
                        video={false}
                        onDisconnected={disconnect}
                        className="w-full max-w-4xl"
                    >
                        <VoiceAssistantUI onDisconnect={disconnect} />
                        <RoomAudioRenderer />
                    </LiveKitRoom>
                ) : (
                    <div className="text-center">
                        {/* æœªé€£æ¥æ™‚çš„ UI */}
                        <div className="w-48 h-48 mx-auto mb-8 rounded-full bg-gradient-to-br from-primary-500/20 to-purple-500/20 flex items-center justify-center">
                            <Mic size={64} className="text-primary-400/50" />
                        </div>

                        <h2 className="text-xl font-semibold text-white mb-2">
                            æº–å‚™å¥½é–‹å§‹å°è©±äº†å—ï¼Ÿ
                        </h2>
                        <p className="text-gray-400 mb-8">
                            é»æ“Šä¸‹æ–¹æŒ‰éˆ•ï¼Œé–‹å§‹èˆ‡ AI ç‰¹åŠ©èªéŸ³å°è©±
                        </p>

                        {error && (
                            <p className="text-red-400 mb-4">{error}</p>
                        )}

                        <button
                            onClick={connect}
                            disabled={isConnecting}
                            className="px-8 py-4 bg-primary-500 hover:bg-primary-600 disabled:bg-gray-600
                                     text-white font-semibold rounded-full transition-all duration-300
                                     shadow-lg shadow-primary-500/25 hover:shadow-primary-500/40"
                        >
                            {isConnecting ? (
                                <span className="flex items-center gap-2">
                                    <span className="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin" />
                                    é€£æ¥ä¸­...
                                </span>
                            ) : (
                                <span className="flex items-center gap-2">
                                    <Phone size={20} />
                                    é–‹å§‹å°è©±
                                </span>
                            )}
                        </button>
                    </div>
                )}
            </main>
        </div>
    );
}

function VoiceAssistantUI({ onDisconnect }: { onDisconnect: () => void }) {
    const { state, audioTrack, agentTranscriptions, userTranscriptions } = useVoiceAssistant();
    const connectionState = useConnectionState();

    // åˆä½µå°è©±è¨˜éŒ„
    const allTranscripts = [
        ...userTranscriptions.map(t => ({ ...t, role: 'user' as const })),
        ...agentTranscriptions.map(t => ({ ...t, role: 'agent' as const })),
    ].sort((a, b) => (a.firstReceivedTime || 0) - (b.firstReceivedTime || 0));

    return (
        <div className="flex flex-col items-center">
            {/* å…‰çƒè¦–è¦ºåŒ– */}
            <div className="relative w-64 h-64 mb-8">
                <VoiceOrb
                    state={state}
                    audioTrack={audioTrack}
                />
            </div>

            {/* ç‹€æ…‹é¡¯ç¤º */}
            <div className="text-center mb-8">
                <p className="text-lg text-white">
                    {state === 'disconnected' && 'å·²æ–·é–‹é€£æ¥'}
                    {state === 'connecting' && 'é€£æ¥ä¸­...'}
                    {state === 'initializing' && 'åˆå§‹åŒ–ä¸­...'}
                    {state === 'listening' && 'ğŸ¤ è†è½ä¸­...'}
                    {state === 'thinking' && 'ğŸ¤” æ€è€ƒä¸­...'}
                    {state === 'speaking' && 'ğŸ’¬ å›æ‡‰ä¸­...'}
                </p>
            </div>

            {/* å°è©±è¨˜éŒ„ */}
            <TranscriptPanel transcripts={allTranscripts} />

            {/* æ§åˆ¶æŒ‰éˆ• */}
            <div className="flex gap-4 mt-8">
                <button
                    onClick={onDisconnect}
                    className="px-6 py-3 bg-red-500/20 hover:bg-red-500/40
                             border border-red-500/50 rounded-full text-red-300
                             transition-all duration-300 flex items-center gap-2"
                >
                    <PhoneOff size={20} />
                    çµæŸå°è©±
                </button>
            </div>
        </div>
    );
}
```

#### 3.3 å…‰çƒè¦–è¦ºåŒ–å…ƒä»¶

```typescript
// app/[locale]/(dashboard)/voice-assistant/components/VoiceOrb.tsx

'use client';

import { useRef, useMemo } from 'react';
import { Canvas, useFrame } from '@react-three/fiber';
import { Sphere, MeshDistortMaterial } from '@react-three/drei';
import * as THREE from 'three';
import { TrackReference } from '@livekit/components-react';

type VoiceState = 'disconnected' | 'connecting' | 'initializing' | 'listening' | 'thinking' | 'speaking';

interface VoiceOrbProps {
    state: VoiceState;
    audioTrack?: TrackReference;
}

export default function VoiceOrb({ state, audioTrack }: VoiceOrbProps) {
    return (
        <div className="w-full h-full">
            <Canvas camera={{ position: [0, 0, 4] }}>
                <ambientLight intensity={0.5} />
                <pointLight position={[10, 10, 10]} intensity={1} />
                <pointLight position={[-10, -10, -10]} intensity={0.5} color="#8b5cf6" />
                <AnimatedOrb state={state} />
                <ParticleField state={state} />
            </Canvas>
        </div>
    );
}

function AnimatedOrb({ state }: { state: VoiceState }) {
    const meshRef = useRef<THREE.Mesh>(null);

    // æ ¹æ“šç‹€æ…‹æ±ºå®šé¡è‰²å’Œæ•ˆæœ
    const config = useMemo(() => {
        switch (state) {
            case 'disconnected':
            case 'connecting':
                return { color: '#6b7280', emissive: '#374151', distort: 0.1, speed: 1 };
            case 'initializing':
                return { color: '#3b82f6', emissive: '#1d4ed8', distort: 0.2, speed: 2 };
            case 'listening':
                return { color: '#10b981', emissive: '#059669', distort: 0.3, speed: 2 };
            case 'thinking':
                return { color: '#8b5cf6', emissive: '#7c3aed', distort: 0.5, speed: 4 };
            case 'speaking':
                return { color: '#06b6d4', emissive: '#0891b2', distort: 0.4, speed: 3 };
            default:
                return { color: '#3b82f6', emissive: '#1d4ed8', distort: 0.2, speed: 2 };
        }
    }, [state]);

    useFrame((frameState) => {
        if (!meshRef.current) return;

        const time = frameState.clock.elapsedTime;

        // åŸºç¤æ—‹è½‰
        meshRef.current.rotation.y = time * 0.2;

        // å‘¼å¸æ•ˆæœ
        const breathe = Math.sin(time * 2) * 0.05;
        meshRef.current.scale.setScalar(1 + breathe);

        // æ€è€ƒæ™‚åŠ é€Ÿæ—‹è½‰
        if (state === 'thinking') {
            meshRef.current.rotation.y = time * 0.8;
            meshRef.current.rotation.x = Math.sin(time * 2) * 0.3;
        }

        // èªªè©±æ™‚è„ˆå‹•
        if (state === 'speaking') {
            const pulse = Math.sin(time * 8) * 0.1;
            meshRef.current.scale.setScalar(1 + breathe + pulse);
        }
    });

    return (
        <Sphere ref={meshRef} args={[1, 64, 64]}>
            <MeshDistortMaterial
                color={config.color}
                emissive={config.emissive}
                emissiveIntensity={0.5}
                distort={config.distort}
                speed={config.speed}
                roughness={0.2}
                metalness={0.8}
            />
        </Sphere>
    );
}

function ParticleField({ state }: { state: VoiceState }) {
    const particlesRef = useRef<THREE.Points>(null);
    const count = 200;

    const positions = useMemo(() => {
        const pos = new Float32Array(count * 3);
        for (let i = 0; i < count; i++) {
            const theta = Math.random() * Math.PI * 2;
            const phi = Math.acos(Math.random() * 2 - 1);
            const r = 2 + Math.random() * 1;

            pos[i * 3] = r * Math.sin(phi) * Math.cos(theta);
            pos[i * 3 + 1] = r * Math.sin(phi) * Math.sin(theta);
            pos[i * 3 + 2] = r * Math.cos(phi);
        }
        return pos;
    }, []);

    useFrame((frameState) => {
        if (!particlesRef.current) return;
        particlesRef.current.rotation.y = frameState.clock.elapsedTime * 0.05;
    });

    const particleColor = useMemo(() => {
        switch (state) {
            case 'listening': return '#10b981';
            case 'thinking': return '#8b5cf6';
            case 'speaking': return '#06b6d4';
            default: return '#3b82f6';
        }
    }, [state]);

    return (
        <points ref={particlesRef}>
            <bufferGeometry>
                <bufferAttribute
                    attach="attributes-position"
                    count={count}
                    array={positions}
                    itemSize={3}
                />
            </bufferGeometry>
            <pointsMaterial
                size={0.03}
                color={particleColor}
                transparent
                opacity={0.6}
                sizeAttenuation
            />
        </points>
    );
}
```

#### 3.4 å°è©±é¡¯ç¤ºå…ƒä»¶

```typescript
// app/[locale]/(dashboard)/voice-assistant/components/TranscriptPanel.tsx

'use client';

import { useEffect, useRef } from 'react';
import { User, Bot } from 'lucide-react';

interface Transcript {
    role: 'user' | 'agent';
    text: string;
    firstReceivedTime?: number;
    isFinal?: boolean;
}

interface TranscriptPanelProps {
    transcripts: Transcript[];
}

export default function TranscriptPanel({ transcripts }: TranscriptPanelProps) {
    const scrollRef = useRef<HTMLDivElement>(null);

    // è‡ªå‹•æ»¾å‹•åˆ°åº•éƒ¨
    useEffect(() => {
        if (scrollRef.current) {
            scrollRef.current.scrollTop = scrollRef.current.scrollHeight;
        }
    }, [transcripts]);

    if (transcripts.length === 0) {
        return (
            <div className="w-full max-w-2xl h-48 flex items-center justify-center text-gray-500">
                å°è©±è¨˜éŒ„å°‡é¡¯ç¤ºåœ¨é€™è£¡
            </div>
        );
    }

    return (
        <div
            ref={scrollRef}
            className="w-full max-w-2xl h-64 overflow-y-auto space-y-4 p-4
                       bg-white/5 rounded-2xl border border-white/10"
        >
            {transcripts.map((transcript, index) => (
                <div
                    key={index}
                    className={`flex gap-3 ${
                        transcript.role === 'user' ? 'justify-end' : 'justify-start'
                    }`}
                >
                    {transcript.role === 'agent' && (
                        <div className="w-8 h-8 rounded-full bg-primary-500/20 flex items-center justify-center flex-shrink-0">
                            <Bot size={16} className="text-primary-400" />
                        </div>
                    )}

                    <div
                        className={`max-w-[80%] px-4 py-2 rounded-2xl ${
                            transcript.role === 'user'
                                ? 'bg-primary-500/20 text-white rounded-br-sm'
                                : 'bg-white/10 text-gray-200 rounded-bl-sm'
                        } ${!transcript.isFinal ? 'opacity-70' : ''}`}
                    >
                        <p className="text-sm">{transcript.text}</p>
                    </div>

                    {transcript.role === 'user' && (
                        <div className="w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center flex-shrink-0">
                            <User size={16} className="text-green-400" />
                        </div>
                    )}
                </div>
            ))}
        </div>
    );
}
```

---

### Phase 4ï¼šAPI æ•´åˆèˆ‡æ¸¬è©¦ï¼ˆ2-3 å¤©ï¼‰

#### 4.1 ä¿®æ”¹ç¾æœ‰ Chat API æ”¯æ´èªéŸ³æ¨¡å¼

```typescript
// app/api/chat/route.ts

// åœ¨ç¾æœ‰çš„ POST handler ä¸­æ–°å¢ voice mode æ”¯æ´

export async function POST(request: NextRequest) {
    const body = await request.json();
    const { message, agent_id, session_id, mode } = body;

    // ... ç¾æœ‰é‚è¼¯ ...

    // å¦‚æœæ˜¯èªéŸ³æ¨¡å¼ï¼Œèª¿æ•´ System Prompt
    let systemPrompt = agent.system_prompt;

    if (mode === 'voice') {
        systemPrompt += `

## èªéŸ³å°è©±æ¨¡å¼
- å›ç­”è«‹æ§åˆ¶åœ¨ 3-5 å¥è©±å…§
- ä¸è¦ä½¿ç”¨ Markdown æ ¼å¼
- ä¸è¦ä½¿ç”¨é …ç›®ç¬¦è™Ÿåˆ—è¡¨
- é‡è¦æ•¸å­—è«‹æ¸…æ¥šå”¸å‡º
- èªæ°£è‡ªç„¶ï¼Œåƒåœ¨å°è©±
`;
    }

    // ... ç¹¼çºŒç¾æœ‰é‚è¼¯ ...
}
```

#### 4.2 æ¸¬è©¦æ¸…å–®

| æ¸¬è©¦é …ç›® | é æœŸçµæœ | ç‹€æ…‹ |
|---------|---------|------|
| éº¥å…‹é¢¨æ¬Šé™è«‹æ±‚ | æ­£ç¢ºå½ˆå‡ºæˆæ¬Šå°è©±æ¡† | â¬œ |
| é€£æ¥ LiveKit | Token é©—è­‰æˆåŠŸï¼Œé€£æ¥å»ºç«‹ | â¬œ |
| èªéŸ³è½‰æ–‡å­— | ä¸­æ–‡è­˜åˆ¥æº–ç¢ºç‡ > 90% | â¬œ |
| Agent å›æ‡‰ | æ­£ç¢ºå‘¼å« /api/chatï¼Œå–å¾—å›æ‡‰ | â¬œ |
| æ–‡å­—è½‰èªéŸ³ | èªéŸ³è‡ªç„¶ï¼Œç„¡æ˜é¡¯æ–·å¥ | â¬œ |
| çŸ¥è­˜åº«æŸ¥è©¢ | æ­£ç¢ºè¿”å›ç›¸é—œçµæœ | â¬œ |
| æˆ°æƒ…å®¤æ•¸æ“š | æ­£ç¢ºè¿”å› KPI æ•¸æ“š | â¬œ |
| æ‰“æ–·åŠŸèƒ½ | å¯åœ¨ AI èªªè©±æ™‚æ‰“æ–· | â¬œ |
| æ–·ç·šé‡é€£ | ç¶²çµ¡ä¸­æ–·å¾Œè‡ªå‹•é‡é€£ | â¬œ |
| å…‰çƒå‹•ç•« | éš¨ç‹€æ…‹è®ŠåŒ–æ­£ç¢ºé¡¯ç¤º | â¬œ |

---

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ

### éƒ¨ç½²æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         éƒ¨ç½²æ¶æ§‹                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                    Vercel                               â”‚    â”‚
â”‚   â”‚  â€¢ Next.js å‰ç«¯                                         â”‚    â”‚
â”‚   â”‚  â€¢ API Routes                                          â”‚    â”‚
â”‚   â”‚  â€¢ è‡ªå‹• SSL                                            â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚              LiveKit Cloud (SaaS)                       â”‚    â”‚
â”‚   â”‚  â€¢ ç„¡éœ€è‡ªå»ºä¼ºæœå™¨                                        â”‚    â”‚
â”‚   â”‚  â€¢ è‡ªå‹•æ“´å±•                                             â”‚    â”‚
â”‚   â”‚  â€¢ å…¨çƒç¯€é»                                             â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚           LiveKit Agent (Python)                        â”‚    â”‚
â”‚   â”‚                                                         â”‚    â”‚
â”‚   â”‚  éƒ¨ç½²é¸é …ï¼š                                              â”‚    â”‚
â”‚   â”‚  A. Railway / Render (æ¨è–¦ï¼Œç°¡å–®)                       â”‚    â”‚
â”‚   â”‚  B. Google Cloud Run (Serverless)                      â”‚    â”‚
â”‚   â”‚  C. AWS ECS / Fargate                                  â”‚    â”‚
â”‚   â”‚  D. è‡ªå»º VPS (DigitalOcean / Linode)                   â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨è–¦ï¼šRailway éƒ¨ç½² Agent

```yaml
# railway.toml

[build]
builder = "dockerfile"

[deploy]
startCommand = "python agent.py start"
healthcheckPath = "/health"
healthcheckTimeout = 300
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3
```

### éƒ¨ç½²æ­¥é©Ÿ

1. **å‰ç«¯ (Vercel)**
   - å·²æœ‰éƒ¨ç½²ï¼Œåªéœ€æ›´æ–°ç’°å¢ƒè®Šæ•¸

2. **Agent (Railway)**
   ```bash
   # å®‰è£ Railway CLI
   npm install -g @railway/cli

   # ç™»å…¥
   railway login

   # åˆå§‹åŒ–å°ˆæ¡ˆ
   cd voice-agent
   railway init

   # è¨­å®šç’°å¢ƒè®Šæ•¸
   railway variables set LIVEKIT_API_KEY=xxx
   railway variables set LIVEKIT_API_SECRET=xxx
   railway variables set DEEPGRAM_API_KEY=xxx
   railway variables set VOICE_AGENT_BASE_URL=https://your-app.com
   railway variables set VOICE_AGENT_API_KEY=xxx

   # éƒ¨ç½²
   railway up
   ```

---

## ğŸ’° æˆæœ¬æ˜ç´°

### æ¯æœˆæˆæœ¬ä¼°ç®—ï¼ˆæ¯æ—¥ä½¿ç”¨ 30 åˆ†é˜ï¼‰

| é …ç›® | å–®åƒ¹ | è¨ˆç®—æ–¹å¼ | æœˆæˆæœ¬ (USD) | æœˆæˆæœ¬ (NTD) |
|-----|------|---------|-------------|-------------|
| **Deepgram STT** | $0.0043/åˆ†é˜ | 30 åˆ† Ã— 30 å¤© | $3.87 | NTD 124 |
| **Google TTS** | $0.016/1K å­—å…ƒ | ~10K å­— Ã— 30 å¤© | $4.80 | NTD 154 |
| **LiveKit Cloud** | $0.004/åˆ†é˜ | 30 åˆ† Ã— 30 å¤© | $3.60 | NTD 115 |
| **Railway (Agent)** | $5/æœˆèµ· | åŸºæœ¬æ–¹æ¡ˆ | $5.00 | NTD 160 |
| **Gemini API** | ç¾æœ‰é¡åº¦ | å·²åŒ…å« | $0 | NTD 0 |
| **åˆè¨ˆ** | | | **~$17.27** | **~NTD 553** |

> ğŸ’¡ ä»¥ä¸Šç‚ºåŸºç¤ç”¨é‡ä¼°ç®—ã€‚è‹¥æ¯æ—¥ä½¿ç”¨ 1 å°æ™‚ï¼Œæœˆæˆæœ¬ç´„ $35 USDï¼ˆNTD 1,120ï¼‰

### å…è²»é¡åº¦

| æœå‹™ | å…è²»é¡åº¦ | èªªæ˜ |
|-----|---------|------|
| LiveKit Cloud | 50 åˆ†é˜/æœˆ | é–‹ç™¼æ¸¬è©¦å¤ ç”¨ |
| Deepgram | $200 é¦–æ¬¡å„²å€¼ | ç´„ 46,000 åˆ†é˜ |
| Google TTS | $300 é¦–æ¬¡å„²å€¼ | ç´„ 18M å­—å…ƒ |
| Railway | $5/æœˆ | Hobby Plan |

---

## ğŸ“… é–‹ç™¼æ™‚ç¨‹

### ç”˜ç‰¹åœ–

```
Week 1                    Week 2                    Week 3
â”‚ Day 1-2 â”‚ Day 3-5 â”‚ Day 6-7 â”‚ Day 8-10 â”‚ Day 11-12 â”‚ Day 13-15 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç’°å¢ƒå»ºç½® â”‚  Agent  â”‚ Agent   â”‚ å‰ç«¯æ•´åˆ  â”‚  å‰ç«¯æ•´åˆ  â”‚ æ¸¬è©¦å„ªåŒ–  â”‚
â”‚ API Key â”‚ é–‹ç™¼(1) â”‚ é–‹ç™¼(2) â”‚ é é¢é–‹ç™¼  â”‚  å…‰çƒå‹•ç•«  â”‚ Bug ä¿®å¾©  â”‚
â”‚ ä¾è³´å®‰è£ â”‚ å·¥å…·å‡½æ•¸ â”‚ æ¸¬è©¦    â”‚ Token API â”‚  å°è©±é¡¯ç¤º  â”‚ éƒ¨ç½²ä¸Šç·š  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é‡Œç¨‹ç¢‘

| é‡Œç¨‹ç¢‘ | å®Œæˆæ—¥ | äº¤ä»˜ç‰© |
|-------|-------|-------|
| M1: ç’°å¢ƒå°±ç·’ | Day 2 | API Key è¨­å®šå®Œæˆã€ä¾è³´å®‰è£å®Œæˆ |
| M2: Agent MVP | Day 7 | Agent å¯èªéŸ³å°è©±ã€å‘¼å« API |
| M3: å‰ç«¯æ•´åˆ | Day 12 | å®Œæ•´é é¢ã€å…‰çƒå‹•ç•«ã€å°è©±é¡¯ç¤º |
| M4: ä¸Šç·š | Day 15 | éƒ¨ç½²å®Œæˆã€æ¸¬è©¦é€šé |

---

## ğŸ”’ å®‰å…¨è€ƒé‡

### èªè­‰èˆ‡æˆæ¬Š

1. **LiveKit Token**
   - æœ‰æ•ˆæœŸé™ï¼š24 å°æ™‚
   - åŒ…å« user_idã€agent_id
   - ç¶å®šç‰¹å®š Room

2. **Agent API å‘¼å«**
   - ä½¿ç”¨å…§éƒ¨ API Key
   - é©—è­‰ X-User-Id Header
   - Rate Limiting

3. **æ•¸æ“šå‚³è¼¸**
   - å…¨ç¨‹ HTTPS/WSS
   - LiveKit åŠ å¯†é€šé“

### éš±ç§ä¿è­·

```typescript
// ä¸è¨˜éŒ„æ•æ„Ÿå°è©±å…§å®¹åˆ°æ—¥èªŒ
const sanitizedLog = (message: string) => {
    // ç§»é™¤å¯èƒ½çš„æ•æ„Ÿè³‡è¨Š
    return message.replace(/\d{10,}/g, '[REDACTED]');
};
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

| å•é¡Œ | å¯èƒ½åŸå›  | è§£æ±ºæ–¹æ¡ˆ |
|-----|---------|---------|
| é€£æ¥å¤±æ•— | Token éæœŸ | é‡æ–°å–å¾— Token |
| èªéŸ³ç„¡æ³•è¾¨è­˜ | éº¥å…‹é¢¨æ¬Šé™æœªæˆæ¬Š | æª¢æŸ¥ç€è¦½å™¨è¨­å®š |
| Agent ç„¡å›æ‡‰ | API å‘¼å«å¤±æ•— | æª¢æŸ¥ Agent æ—¥èªŒ |
| å›æ‡‰å»¶é²é«˜ | ç¶²çµ¡å•é¡Œ | æª¢æŸ¥ LiveKit Region |
| TTS ç„¡è²éŸ³ | ç€è¦½å™¨è‡ªå‹•æ’­æ”¾é™åˆ¶ | éœ€è¦ä½¿ç”¨è€…äº’å‹• |

### ç›£æ§æŒ‡æ¨™

```typescript
// å»ºè­°ç›£æ§çš„æŒ‡æ¨™
const metrics = {
    // å»¶é²
    stt_latency_ms: 0,      // èªéŸ³è½‰æ–‡å­—å»¶é²
    llm_latency_ms: 0,      // LLM å›æ‡‰å»¶é²
    tts_latency_ms: 0,      // æ–‡å­—è½‰èªéŸ³å»¶é²
    total_latency_ms: 0,    // ç¸½å»¶é²

    // æˆåŠŸç‡
    stt_success_rate: 0,    // STT æˆåŠŸç‡
    llm_success_rate: 0,    // LLM æˆåŠŸç‡
    connection_success_rate: 0, // é€£æ¥æˆåŠŸç‡

    // ä½¿ç”¨é‡
    daily_minutes: 0,       // æ¯æ—¥ä½¿ç”¨åˆ†é˜æ•¸
    daily_sessions: 0,      // æ¯æ—¥å°è©±æ¬¡æ•¸
};
```

---

## ğŸ“š åƒè€ƒè³‡æº

### å®˜æ–¹æ–‡ä»¶

- [LiveKit Agents æ–‡ä»¶](https://docs.livekit.io/agents/)
- [LiveKit React Components](https://docs.livekit.io/realtime/components/)
- [Deepgram API æ–‡ä»¶](https://developers.deepgram.com/)
- [Google Cloud TTS æ–‡ä»¶](https://cloud.google.com/text-to-speech/docs)

### ç¯„ä¾‹ç¨‹å¼ç¢¼

- [LiveKit Agents Examples](https://github.com/livekit/agents/tree/main/examples)
- [LiveKit Agents Playground](https://github.com/livekit/agents-playground)

### ç¤¾ç¾¤è³‡æº

- [LiveKit Discord](https://discord.gg/livekit)
- [LiveKit GitHub Discussions](https://github.com/livekit/livekit/discussions)

---

## âœ… é©—æ”¶æ¨™æº–

### åŠŸèƒ½é©—æ”¶

| åŠŸèƒ½ | é©—æ”¶æ¨™æº– | å„ªå…ˆç´š |
|-----|---------|-------|
| èªéŸ³è¼¸å…¥ | ä¸­æ–‡è­˜åˆ¥æº–ç¢ºç‡ > 90% | P0 |
| èªéŸ³è¼¸å‡º | è‡ªç„¶åº¦è©•åˆ† > 4/5 | P0 |
| çŸ¥è­˜åº«æŸ¥è©¢ | æ­£ç¢ºè¿”å›ç›¸é—œçµæœ | P0 |
| æˆ°æƒ…å®¤æ•¸æ“š | æ­£ç¢ºè¿”å› KPI | P0 |
| å°è©±å»¶é² | ç¸½å»¶é² < 3 ç§’ | P1 |
| æ‰“æ–·åŠŸèƒ½ | å¯æ­£å¸¸æ‰“æ–· AI èªªè©± | P1 |
| å…‰çƒå‹•ç•« | æµæš¢ã€éš¨ç‹€æ…‹è®ŠåŒ– | P2 |

### æ•ˆèƒ½é©—æ”¶

| æŒ‡æ¨™ | ç›®æ¨™å€¼ |
|-----|-------|
| é¦–æ¬¡é€£æ¥æ™‚é–“ | < 3 ç§’ |
| èªéŸ³è½‰æ–‡å­—å»¶é² | < 500ms |
| AI å›æ‡‰å»¶é² | < 2 ç§’ |
| ç¸½å°è©±å»¶é² | < 3 ç§’ |
| éŒ¯èª¤ç‡ | < 5% |

---

**æ–‡ä»¶ç‰ˆæœ¬**ï¼šv1.0
**æœ€å¾Œæ›´æ–°**ï¼š2026-01-17
**ä½œè€…**ï¼šEAKAP ç³»çµ±æ¶æ§‹åœ˜éšŠ
